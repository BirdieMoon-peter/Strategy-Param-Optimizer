# run_optimizer.py ä½¿ç”¨æŒ‡å—

## ğŸ“– ç®€ä»‹

`run_optimizer.py` æ˜¯ä¸€ä¸ªé€šç”¨çš„é‡åŒ–ç­–ç•¥ä¼˜åŒ–å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒä»»æ„æ ‡çš„æ•°æ®å’Œç­–ç•¥è„šæœ¬çš„å‚æ•°ä¼˜åŒ–ã€‚å®ƒé›†æˆäº†è´å¶æ–¯ä¼˜åŒ–ç®—æ³•å’Œå¯é€‰çš„LLMè¾…åŠ©åˆ†æåŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

âœ… **é€šç”¨æ€§å¼º** - æ”¯æŒä»»æ„CSVæ ¼å¼çš„æ ‡çš„æ•°æ®å’Œä»»æ„Backtraderç­–ç•¥  
âœ… **å¤šç›®æ ‡ä¼˜åŒ–** - æ”¯æŒå¤æ™®æ¯”ç‡ã€å¹´åŒ–æ”¶ç›Šç‡ã€æœ€å¤§å›æ’¤ç­‰å¤šç§ä¼˜åŒ–ç›®æ ‡  
âœ… **æ‰¹é‡å¤„ç†** - æ”¯æŒä¸€æ¬¡ä¼˜åŒ–å¤šä¸ªCSVæ–‡ä»¶ï¼Œè‡ªåŠ¨æ‰¹é‡å¤„ç†  
âœ… **æ™ºèƒ½å‚æ•°ç©ºé—´** - è‡ªåŠ¨æ ¹æ®å‚æ•°ç±»å‹ç”Ÿæˆåˆç†çš„æœç´¢èŒƒå›´ï¼ˆåˆå§‹Â±30%ï¼‰ï¼Œæå‡ä¼˜åŒ–æ•ˆç‡  
âœ… **è‡ªåŠ¨è¾¹ç•Œæ‰©å±•** - å½“æœ€ä¼˜å‚æ•°è§¦åŠè¾¹ç•Œæ—¶ï¼Œè‡ªåŠ¨æ‰©å±•æœç´¢èŒƒå›´å¹¶è¿›è¡ŒäºŒæ¬¡æœç´¢  
âœ… **æ­£æ€åˆ†å¸ƒé‡‡æ ·** - ğŸ†• v2.1 åˆå§‹æ¢ç´¢é˜¶æ®µä½¿ç”¨æ­£æ€åˆ†å¸ƒé‡‡æ ·ï¼Œæ›¿ä»£ä¼ ç»Ÿå‡åŒ€é‡‡æ ·ï¼Œæ›´å¥½åœ°æ¢ç´¢å‚æ•°ç©ºé—´  
âœ… **ä¸¤é˜¶æ®µä¼˜åŒ–** - ğŸ†• v2.1 æ¢ç´¢é˜¶æ®µï¼ˆæ­£æ€åˆ†å¸ƒï¼‰+ åˆ©ç”¨é˜¶æ®µï¼ˆè´å¶æ–¯TPEï¼‰ï¼Œå¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨  
âœ… **åŠ¨æ€è¯•éªŒæ¬¡æ•°** - ğŸ†• v2.1 æ ¹æ®å‚æ•°æ•°é‡è‡ªåŠ¨è°ƒæ•´è¯•éªŒæ¬¡æ•°ï¼Œç¡®ä¿å……åˆ†æ¢ç´¢  
âœ… **è¾¹ç•ŒäºŒæ¬¡æœç´¢** - ğŸ†• v2.1 æ™ºèƒ½æ£€æµ‹è¾¹ç•Œå‚æ•°ï¼Œè‡ªåŠ¨æ‰©å±•èŒƒå›´å¹¶è¿›è¡Œé’ˆå¯¹æ€§æœç´¢  
âœ… **åŒæ¨¡å¼æŒ‡æ ‡è®¡ç®—** - ğŸ†• v2.2 æ”¯æŒ trade_log ç²¾ç¡®è®¡ç®—å’Œ empyrical ä¸“ä¸šæŒ‡æ ‡ä¸¤ç§æ¨¡å¼  
âœ… **åˆ†é’Ÿæ•°æ®ä¼˜åŒ–** - ğŸ†• v2.2 å®Œå–„çš„æ—¥å†…æ•°æ®å¤„ç†å’Œå¹´åŒ–æœºåˆ¶ï¼Œè‡ªåŠ¨èšåˆä¸ºæ—¥æ”¶ç›Šç‡  
âœ… **ä¸“ä¸šæŒ‡æ ‡è®¡ç®—** - ä½¿ç”¨ pyfolio/empyrical æ¡†æ¶è®¡ç®—ä¸“ä¸šé‡‘èæŒ‡æ ‡ï¼ˆSharpeã€Sortinoã€Calmarã€Omegaç­‰ï¼‰  
âœ… **å‚æ•°ç©ºé—´åˆ†æ** - è‡ªåŠ¨åˆ†æä¼˜åŒ–ç»“æœï¼Œç»™å‡ºå‚æ•°ç©ºé—´æ”¹è¿›å»ºè®®  
âœ… **é€‰æ‹©æ€§ä¼˜åŒ–** - æ”¯æŒæŒ‡å®šè¦ä¼˜åŒ–çš„å‚æ•°ï¼Œå…¶ä»–å‚æ•°ä¿æŒé»˜è®¤å€¼  
âœ… **LLMé›†æˆ** - å¯é€‰é›†æˆå¤§è¯­è¨€æ¨¡å‹è¿›è¡Œæ™ºèƒ½å‚æ•°åˆ†æ  
âœ… **å‘½ä»¤è¡Œå‹å¥½** - ç®€å•æ˜“ç”¨çš„å‘½ä»¤è¡Œæ¥å£ï¼Œæ”¯æŒæ‰¹å¤„ç†  
âœ… **è¯¦ç»†è¾“å‡º** - ç”ŸæˆJSONæ ¼å¼ç»“æœå’Œå¯è¯»çš„æ–‡æœ¬æ‘˜è¦

### ğŸ“š å¿«é€Ÿå¯¼èˆª

- **å›æµ‹æŒ‡æ ‡è®¡ç®—** â†’ [ğŸ¯ å›æµ‹æŒ‡æ ‡è®¡ç®—æ–¹æ³•](#-å›æµ‹æŒ‡æ ‡è®¡ç®—æ–¹æ³•)
- **åˆ†é’Ÿæ•°æ®å¤„ç†** â†’ [åˆ†é’Ÿæ•°æ®å¤„ç†æœºåˆ¶](#åˆ†é’Ÿæ•°æ®å¤„ç†æœºåˆ¶)
- **ç­–ç•¥è¦æ±‚** â†’ [ğŸ”§ ç­–ç•¥è„šæœ¬è¦æ±‚](#-ç­–ç•¥è„šæœ¬è¦æ±‚)
- **æœ€ä½³å®è·µ** â†’ [ğŸ“ æœ€ä½³å®è·µ](#-æœ€ä½³å®è·µ)
- **å¸¸è§é—®é¢˜** â†’ [â“ å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ€ç®€å•çš„ç”¨æ³•

```bash
# å•ä¸ªæ–‡ä»¶ä¼˜åŒ–
python run_optimizer.py -d project_trend/data/AG.csv -s project_trend/src/Aberration.py

# æ‰¹é‡ä¼˜åŒ–å¤šä¸ªæ–‡ä»¶ï¼ˆæ–°åŠŸèƒ½ï¼‰
python run_optimizer.py -d project_trend/data/BTC.csv project_trend/data/ETH.csv -s project_trend/src/Aberration.py

# ä½¿ç”¨é€šé…ç¬¦æ‰¹é‡ä¼˜åŒ–
python run_optimizer.py -d project_trend/data/*.csv -s project_trend/src/Aberration.py
```

è¿™å°†ä½¿ç”¨é»˜è®¤å‚æ•°ï¼ˆå¤æ™®æ¯”ç‡ä¼˜åŒ–ï¼Œ50æ¬¡è¯•éªŒï¼‰å¯¹æŒ‡å®šæ ‡çš„è¿è¡Œç­–ç•¥çš„å‚æ•°ä¼˜åŒ–ã€‚

---

## ğŸ“¦ ç¯å¢ƒè¦æ±‚

### ä¾èµ–åŒ…

ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹PythonåŒ…ï¼š

```bash
pip install pandas backtrader optuna matplotlib requests empyrical
```

æˆ–ä½¿ç”¨é¡¹ç›®çš„ `requirements.txt`ï¼š

```bash
cd Optimizer
pip install -r requirements.txt
```

**å…³é”®ä¾èµ–ï¼š**
- `backtrader>=1.9.76` - å›æµ‹å¼•æ“
- `optuna>=3.0.0` - è´å¶æ–¯ä¼˜åŒ–æ¡†æ¶
- `empyrical>=0.5.5` - ä¸“ä¸šé‡‘èæŒ‡æ ‡è®¡ç®—ï¼ˆæ–°å¢ï¼‰
- `pandas`, `numpy` - æ•°æ®å¤„ç†
- `matplotlib` - å¯è§†åŒ–ï¼ˆå¯é€‰ï¼‰

### Pythonç‰ˆæœ¬

- Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬

---

## ğŸ“‹ å‚æ•°è¯´æ˜

### å¿…éœ€å‚æ•°

| å‚æ•° | ç®€å†™ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `--data` | `-d` | æ ‡çš„æ•°æ®CSVæ–‡ä»¶è·¯å¾„ï¼ˆæ”¯æŒå¤šä¸ªæ–‡ä»¶ï¼‰ | `data/BTC.csv data/ETH.csv` |
| `--strategy` | `-s` | ç­–ç•¥è„šæœ¬æ–‡ä»¶è·¯å¾„ | `project_trend/src/Aberration.py` |

### ä¼˜åŒ–å‚æ•°

| å‚æ•° | ç®€å†™ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--objective` | `-o` | `sharpe_ratio` | ä¼˜åŒ–ç›®æ ‡ |
| `--trials` | `-t` | `50` | åŸºç¡€è¯•éªŒæ¬¡æ•°ï¼ˆå¯ç”¨åŠ¨æ€è¯•éªŒä¼šè‡ªåŠ¨è°ƒæ•´ï¼‰ |
| `--params-file` | `-p` | - | æŒ‡å®šè¦ä¼˜åŒ–çš„å‚æ•°åˆ—è¡¨æ–‡ä»¶ |
| `--space-config` | `-S` | - | æ‰‹åŠ¨æŒ‡å®šå‚æ•°ç©ºé—´é…ç½®ï¼ˆJSONæ–‡ä»¶ï¼‰ |

### v2.1 æ–°å¢å‚æ•° ğŸ†•

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `--no-enhanced-sampler` | `False` | ç¦ç”¨å¢å¼ºé‡‡æ ·å™¨ï¼Œä½¿ç”¨ä¼ ç»Ÿå‡åŒ€é‡‡æ · |
| `--no-dynamic-trials` | `False` | ç¦ç”¨åŠ¨æ€è¯•éªŒæ¬¡æ•°ï¼Œä½¿ç”¨å›ºå®šå€¼ |
| `--no-boundary-search` | `False` | ç¦ç”¨è¾¹ç•ŒäºŒæ¬¡æœç´¢ |
| `--max-boundary-rounds` | `2` | è¾¹ç•ŒäºŒæ¬¡æœç´¢æœ€å¤§è½®æ•° |

**å¯é€‰çš„ä¼˜åŒ–ç›®æ ‡ï¼š**
- `sharpe_ratio` - å¤æ™®æ¯”ç‡ï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰ - ä½¿ç”¨ empyrical è®¡ç®—
- `sortino_ratio` - ç´¢æè¯ºæ¯”ç‡ - ä½¿ç”¨ empyrical è®¡ç®—ï¼Œåªè€ƒè™‘ä¸‹è¡Œé£é™©
- `calmar_ratio` - å¡ç›æ¯”ç‡ - ä½¿ç”¨ empyrical è®¡ç®—
- `annual_return` - å¹´åŒ–æ”¶ç›Šç‡
- `total_return` - æ€»æ”¶ç›Šç‡
- `max_drawdown` - æœ€å¤§å›æ’¤ï¼ˆæœ€å°åŒ–ï¼‰

### LLMå‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `--use-llm` | `False` | æ˜¯å¦ä½¿ç”¨LLMè¾…åŠ©ä¼˜åŒ– |
| `--llm-type` | `ollama` | LLMç±»å‹ï¼ˆollama/openai/customï¼‰ |
| `--llm-model` | `xuanyuan` | LLMæ¨¡å‹åç§° |
| `--llm-url` | `http://localhost:11434` | LLM API URL |
| `--api-key` | - | APIå¯†é’¥ï¼ˆOpenAIéœ€è¦ï¼‰ |
| `--timeout` | `180` | LLMè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |

### è¾“å‡ºå‚æ•°

| å‚æ•° | ç®€å†™ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--output` | `-O` | `./optimization_results` | è¾“å‡ºç›®å½• |
| `--quiet` | `-q` | `False` | é™é»˜æ¨¡å¼ï¼ˆå‡å°‘è¾“å‡ºï¼‰ |

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ç”¨æ³•

```bash
# 1. æœ€ç®€å•ç”¨æ³•ï¼ˆä¼˜åŒ–æ‰€æœ‰å‚æ•°ï¼‰
python run_optimizer.py -d data.csv -s strategy.py

# 2. æ‰¹é‡ä¼˜åŒ–å¤šä¸ªæ ‡çš„ï¼ˆæ–°åŠŸèƒ½ï¼‰
python run_optimizer.py -d data/BTC.csv data/ETH.csv data/SOL.csv -s strategy.py

# 3. ä½¿ç”¨é€šé…ç¬¦æ‰¹é‡ä¼˜åŒ–
python run_optimizer.py -d data/*.csv -s strategy.py

# 4. æŒ‡å®šè¯•éªŒæ¬¡æ•°
python run_optimizer.py -d data.csv -s strategy.py --trials 100

# 5. åªä¼˜åŒ–æŒ‡å®šå‚æ•°ï¼ˆæ¨èï¼‰
echo "period" > params.txt
echo "devfactor" >> params.txt
python run_optimizer.py -d data.csv -s strategy.py --params-file params.txt

# 6. æ›´æ”¹ä¼˜åŒ–ç›®æ ‡
python run_optimizer.py -d data.csv -s strategy.py --objective sortino_ratio

# 7. ä½¿ç”¨ LLM è¾…åŠ©
python run_optimizer.py -d data.csv -s strategy.py --use-llm
```

### å‚æ•°æ–‡ä»¶æ ¼å¼

åˆ›å»º `params.txt`ï¼Œæ¯è¡Œä¸€ä¸ªå‚æ•°åï¼š

```txt
# è¿™æ˜¯æ³¨é‡Šï¼Œä»¥ # å¼€å¤´
period
devfactor
# ç©ºè¡Œä¼šè¢«å¿½ç•¥
```

**æ³¨æ„ï¼š** å‚æ•°åå¿…é¡»ä¸ç­–ç•¥ä¸­å®šä¹‰çš„å®Œå…¨ä¸€è‡´

### æ‰‹åŠ¨é…ç½®å‚æ•°ç©ºé—´ ğŸ†•

å½“æ­£åˆ™è¡¨è¾¾å¼æ— æ³•åŒ¹é…å‚æ•°ã€LLM æ— æ³•ç»™å‡ºåˆé€‚çš„å‚æ•°ç©ºé—´ï¼Œæˆ–éœ€è¦ç²¾ç¡®æ§åˆ¶æœç´¢èŒƒå›´æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ JSON é…ç½®æ–‡ä»¶æ‰‹åŠ¨æŒ‡å®šå‚æ•°ç©ºé—´ã€‚

#### ğŸ“ ä½¿ç”¨åœºæ™¯

1. **æ­£åˆ™è¡¨è¾¾å¼æœä¸åˆ°å‚æ•°**ï¼šå‚æ•°åä¸ç¬¦åˆå†…ç½®è§„åˆ™æ¨¡å¼
2. **LLM è¿”å›ä¸åˆé€‚**ï¼šLLM ç»™å‡ºçš„èŒƒå›´ä¸ç¬¦åˆé¢„æœŸ
3. **éœ€è¦ç²¾ç¡®æ§åˆ¶**ï¼šæ ¹æ®ç»éªŒæˆ–åˆ†æéœ€è¦ç‰¹å®šæœç´¢èŒƒå›´
4. **ç‰¹æ®Šå‚æ•°ç±»å‹**ï¼šå‚æ•°æœ‰ç‰¹æ®Šçš„ä¸šåŠ¡çº¦æŸ

#### ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# ä½¿ç”¨è‡ªå®šä¹‰å‚æ•°ç©ºé—´
python run_optimizer.py -d data.csv -s strategy.py --space-config my_space_config.json

# æˆ–ä½¿ç”¨ç®€å†™
python run_optimizer.py -d data.csv -s strategy.py -S my_space_config.json
```

#### ğŸ“‹ é…ç½®æ–‡ä»¶æ ¼å¼

åˆ›å»º JSON é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `my_space_config.json`ï¼‰ï¼š

```json
{
    "param_space": {
        "period": {
            "min": 10,
            "max": 50,
            "step": 1,
            "distribution": "int_uniform"
        },
        "devfactor": {
            "min": 1.0,
            "max": 4.0,
            "step": null,
            "distribution": "uniform"
        }
    }
}
```

#### âš™ï¸ é…ç½®å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `min` | number | âœ… | å‚æ•°æœ€å°å€¼ | `10` |
| `max` | number | âœ… | å‚æ•°æœ€å¤§å€¼ | `50` |
| `step` | number/null | å¯é€‰ | æ­¥é•¿ï¼ˆæ•´å‹å¿…éœ€ï¼Œæµ®ç‚¹å‹å¯è®¾ä¸º `null`ï¼‰ | `1` æˆ– `null` |
| `distribution` | string | å¯é€‰ | åˆ†å¸ƒç±»å‹ | `"int_uniform"` |
| `description` | string | å¯é€‰ | å‚æ•°æè¿°ï¼ˆä»…ç”¨äºæ–‡æ¡£ï¼‰ | `"å‘¨æœŸå‚æ•°"` |

**åˆ†å¸ƒç±»å‹ï¼ˆdistributionï¼‰ï¼š**
- `int_uniform` - æ•´æ•°å‡åŒ€åˆ†å¸ƒï¼ˆæ•´å‹å‚æ•°ï¼Œå¦‚å‘¨æœŸã€çª—å£ï¼‰
- `uniform` - è¿ç»­å‡åŒ€åˆ†å¸ƒï¼ˆæµ®ç‚¹å‹å‚æ•°ï¼Œå¦‚å€æ•°ã€æ¯”ç‡ï¼‰
- `log_uniform` - å¯¹æ•°å‡åŒ€åˆ†å¸ƒï¼ˆè·¨æ•°é‡çº§å‚æ•°ï¼Œå¦‚å­¦ä¹ ç‡ï¼‰

#### ğŸ’¡ é…ç½®ç¤ºä¾‹

**ç¤ºä¾‹ 1ï¼šå¸ƒæ—å¸¦ç­–ç•¥å‚æ•°**

```json
{
    "param_space": {
        "period": {
            "min": 15,
            "max": 30,
            "step": 1,
            "distribution": "int_uniform"
        },
        "devfactor": {
            "min": 1.5,
            "max": 3.0,
            "step": null,
            "distribution": "uniform"
        }
    }
}
```

**ç¤ºä¾‹ 2ï¼šRSI ç­–ç•¥å‚æ•°**

```json
{
    "param_space": {
        "rsi_period": {
            "min": 5,
            "max": 30,
            "step": 1,
            "distribution": "int_uniform"
        },
        "rsi_oversold": {
            "min": 20,
            "max": 40,
            "step": 1,
            "distribution": "int_uniform"
        },
        "rsi_overbought": {
            "min": 60,
            "max": 80,
            "step": 1,
            "distribution": "int_uniform"
        }
    }
}
```


#### ğŸ¯ ä½¿ç”¨æŠ€å·§

1. **åªé…ç½®éœ€è¦çš„å‚æ•°**ï¼šæœªé…ç½®çš„å‚æ•°ä¼šè‡ªåŠ¨ä½¿ç”¨æ™ºèƒ½è§„åˆ™ç”ŸæˆèŒƒå›´
2. **æ··åˆä½¿ç”¨**ï¼šå¯ä»¥åªé…ç½®éƒ¨åˆ†å‚æ•°ï¼Œå…¶ä»–å‚æ•°ä½¿ç”¨è‡ªåŠ¨è§„åˆ™
3. **ä¿å­˜é…ç½®**ï¼šå°†å¸¸ç”¨é…ç½®ä¿å­˜ä¸ºæ¨¡æ¿ï¼Œæ–¹ä¾¿å¤ç”¨
4. **éªŒè¯é…ç½®**ï¼šè¿è¡Œå‰æ£€æŸ¥ `min < max`ï¼Œç¡®ä¿é…ç½®åˆç†

#### â“ å¸¸è§é—®é¢˜

**Q: é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°åå¿…é¡»å’Œç­–ç•¥ä¸­å®Œå…¨ä¸€è‡´å—ï¼Ÿ**  
A: æ˜¯çš„ï¼Œå‚æ•°åå¿…é¡»ä¸ç­–ç•¥ç±»ä¸­å®šä¹‰çš„å‚æ•°åå®Œå…¨ä¸€è‡´ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰ã€‚

**Q: å¦‚æœé…ç½®äº†ä¸å­˜åœ¨çš„å‚æ•°ä¼šæ€æ ·ï¼Ÿ**  
A: ç³»ç»Ÿä¼šå¿½ç•¥ä¸å­˜åœ¨çš„å‚æ•°ï¼Œåªåº”ç”¨å­˜åœ¨çš„å‚æ•°é…ç½®ã€‚

**Q: å¯ä»¥åªé…ç½®éƒ¨åˆ†å‚æ•°å—ï¼Ÿ**  
A: å¯ä»¥ï¼Œæœªé…ç½®çš„å‚æ•°ä¼šä½¿ç”¨æ™ºèƒ½è§„åˆ™è‡ªåŠ¨ç”ŸæˆèŒƒå›´ã€‚

**Q: `step` ä»€ä¹ˆæ—¶å€™è®¾ä¸º `null`ï¼Ÿ**  
A: æµ®ç‚¹å‹å‚æ•°é€šå¸¸è®¾ä¸º `null`ï¼ˆè¿ç»­å€¼ï¼‰ï¼Œæ•´å‹å‚æ•°éœ€è¦æŒ‡å®šæ­¥é•¿ï¼ˆé€šå¸¸ä¸º 1ï¼‰ã€‚

#### ğŸ“ å‚è€ƒæ–‡ä»¶

- ç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼š`my_space_config.json`
- å®Œæ•´ç¤ºä¾‹ï¼šæŸ¥çœ‹é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ç¤ºä¾‹

### å®Œæ•´ç¤ºä¾‹

**ç¤ºä¾‹ 1ï¼šåŸºæœ¬ä¼˜åŒ–**
```bash
python run_optimizer.py \
  --data project_trend/data/BTC.csv \
  --strategy project_trend/src/Aberration.py \
  --params-file params.txt \
  --objective sharpe_ratio \
  --trials 100 \
  --output ./results
```

**ç¤ºä¾‹ 2ï¼šä½¿ç”¨è‡ªå®šä¹‰å‚æ•°ç©ºé—´**
```bash
python run_optimizer.py \
  --data project_trend/data/BTC.csv \
  --strategy project_trend/src/Aberration.py \
  --space-config my_space_config.json \
  --objective sharpe_ratio \
  --trials 100 \
  --output ./results
```

**ç¤ºä¾‹ 3ï¼šç»„åˆä½¿ç”¨ï¼ˆæŒ‡å®šå‚æ•° + è‡ªå®šä¹‰ç©ºé—´ï¼‰**
```bash
# åªä¼˜åŒ– period å’Œ devfactorï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰èŒƒå›´
python run_optimizer.py \
  --data project_trend/data/BTC.csv \
  --strategy project_trend/src/Aberration.py \
  --params-file params.txt \
  --space-config my_space_config.json \
  --trials 100
```

---

## ğŸ¯ å›æµ‹æŒ‡æ ‡è®¡ç®—æ–¹æ³•

è°ƒå‚å·¥å…·ä½¿ç”¨**åŒå¼•æ“è®¡ç®—æ¨¡å¼**ï¼Œæ ¹æ®ç­–ç•¥ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä½³è®¡ç®—æ–¹å¼ã€‚

### è®¡ç®—æ¨¡å¼é€‰æ‹©é€»è¾‘

```
ç­–ç•¥æ˜¯å¦æœ‰ trade_logï¼Ÿ
    â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ trade_log æ¨¡å¼ï¼ˆç²¾ç¡®è®¡ç®—ï¼‰
    â””â”€ å¦ â†’ ä½¿ç”¨ empyrical æ¨¡å¼ï¼ˆä¸“ä¸šæŒ‡æ ‡ï¼‰
```

### æ¨¡å¼1: trade_log ç²¾ç¡®è®¡ç®—ï¼ˆé»˜è®¤ä¼˜å…ˆï¼‰

**é€‚ç”¨åœºæ™¯ï¼š** ç­–ç•¥æ‰‹åŠ¨ç»´æŠ¤ `self.trade_log` å±æ€§ï¼ˆå¦‚æ‚¨çš„ multivwap2.py ç­–ç•¥ï¼‰

**è®¡ç®—æµç¨‹ï¼š**
1. **æå–äº¤æ˜“è®°å½•**ï¼šè¯»å–ç­–ç•¥çš„ `trade_log`ï¼ˆæ¯ç¬”äº¤æ˜“çš„å®Œæ•´ä¿¡æ¯ï¼‰
2. **æŒ‰æ—¥èšåˆ**ï¼šå°†åˆ†é’Ÿçº§äº¤æ˜“æŒ‰æ—¥æœŸåˆ†ç»„ï¼Œæ±‡æ€»æ¯æ—¥ç›ˆäº
   ```python
   æ—¥æœŸ2024-01-15: äº¤æ˜“1(+150) + äº¤æ˜“2(-50) + äº¤æ˜“3(+200) = +300å…ƒ
   æ—¥æœŸ2024-01-16: äº¤æ˜“4(-100) = -100å…ƒ
   ```
3. **æ„å»ºèµ„äº§æ›²çº¿**ï¼šä»åˆå§‹èµ„é‡‘å¼€å§‹ç´¯åŠ æ¯æ—¥ç›ˆäº
   ```python
   ç¬¬0å¤©: 100,000 (åˆå§‹)
   ç¬¬1å¤©: 100,300 (+300)
   ç¬¬2å¤©: 100,200 (-100)
   ```
4. **è®¡ç®—æ—¥æ”¶ç›Šç‡**ï¼š`(å½“æ—¥èµ„äº§ - å‰æ—¥èµ„äº§) / å‰æ—¥èµ„äº§`
5. **è®¡ç®—æ ¸å¿ƒæŒ‡æ ‡**ï¼š
   - **å¤æ™®æ¯”ç‡** = (æ—¥å‡æ”¶ç›Š / æ—¥æ”¶ç›Šæ ‡å‡†å·®) Ã— âˆš252
   - **æœ€å¤§å›æ’¤** = min((èµ„äº§å€¼ - å†å²æœ€é«˜) / å†å²æœ€é«˜)
   - **å¹´åŒ–æ”¶ç›Š** = (æœŸæœ«èµ„äº§/æœŸåˆèµ„äº§)^(1/å¹´æ•°) - 1
   - **èƒœç‡** = ç›ˆåˆ©äº¤æ˜“æ•° / æ€»äº¤æ˜“æ•°
   - **ç›ˆäºæ¯”** = å¹³å‡ç›ˆåˆ© / å¹³å‡äºæŸ

**å…³é”®ç‰¹ç‚¹ï¼š**
- âœ… **åˆ†é’Ÿçº§ç²¾åº¦**ï¼šä¿ç•™æ¯ç¬”äº¤æ˜“çš„å®Œæ•´ç»†èŠ‚
- âœ… **æ‰‹ç»­è´¹é€æ˜**ï¼šä½¿ç”¨ç­–ç•¥è‡ªå·±è®¡ç®—çš„å‡€ç›ˆäº
- âœ… **è‡ªåŠ¨è½¬æ¢**ï¼šæœ€ç»ˆè½¬ä¸ºæ—¥æ”¶ç›Šç‡è¿›è¡Œå¹´åŒ–
- âœ… **é€‚åˆé«˜é¢‘**ï¼šç‰¹åˆ«é€‚åˆæ—¥å†…åˆ†é’Ÿçº§ç­–ç•¥

**ä»£ç ä½ç½®ï¼š** [`Optimizer/backtest_engine.py:400-510`](Optimizer/backtest_engine.py#L400-L510)

---

### æ¨¡å¼2: empyrical ä¸“ä¸šæŒ‡æ ‡ï¼ˆé™çº§æ–¹æ¡ˆï¼‰

**é€‚ç”¨åœºæ™¯ï¼š** ç­–ç•¥æœªç»´æŠ¤ `trade_log`ï¼Œæˆ–è®¾ç½® `use_trade_log_metrics=False`

**è®¡ç®—æµç¨‹ï¼š**
1. **è·å–æ”¶ç›Šç‡**ï¼šä½¿ç”¨ backtrader çš„ `TimeReturn` åˆ†æå™¨
   - æ—¥å†…æ•°æ®ï¼šè‡ªåŠ¨ä½¿ç”¨ `timeframe=bt.TimeFrame.Days` è·å–æ—¥æ”¶ç›Šç‡
   - æ—¥çº¿æ•°æ®ï¼šç›´æ¥ä½¿ç”¨åŸå§‹é¢‘ç‡
2. **empyrical è®¡ç®—**ï¼šè°ƒç”¨ä¸“ä¸šé‡‘èåº“è®¡ç®—æŒ‡æ ‡
   ```python
   from empyrical import sharpe_ratio, sortino_ratio, calmar_ratio
   sharpe = sharpe_ratio(daily_returns, risk_free=0, period='daily')
   ```
3. **æ”¯æŒçš„æŒ‡æ ‡**ï¼š
   - **Sharpe Ratio**ï¼šå¤æ™®æ¯”ç‡ï¼ˆæ”¶ç›Š/æ³¢åŠ¨ï¼‰
   - **Sortino Ratio**ï¼šç´¢æè¯ºæ¯”ç‡ï¼ˆåªè€ƒè™‘ä¸‹è¡Œé£é™©ï¼‰
   - **Calmar Ratio**ï¼šå¡ç›æ¯”ç‡ï¼ˆæ”¶ç›Š/æœ€å¤§å›æ’¤ï¼‰
   - **Omega Ratio**ï¼šæ¬§ç±³ä¼½æ¯”ç‡ï¼ˆæ”¶ç›Šæ¦‚ç‡/æŸå¤±æ¦‚ç‡ï¼‰
   - **Value at Risk**ï¼š95%ç½®ä¿¡åº¦æœ€å¤§æŸå¤±
   - **Tail Ratio**ï¼šå°¾éƒ¨æ¯”ç‡ï¼ˆå³å°¾/å·¦å°¾ï¼‰
   - **Annual Volatility**ï¼šå¹´åŒ–æ³¢åŠ¨ç‡

**å…³é”®ç‰¹ç‚¹ï¼š**
- âœ… **ä¸“ä¸šæ ‡å‡†**ï¼šä½¿ç”¨é‡åŒ–é‡‘èè¡Œä¸šæ ‡å‡†åº“
- âœ… **æŒ‡æ ‡ä¸°å¯Œ**ï¼šæä¾›å¤šç»´åº¦é£é™©è¯„ä¼°
- âœ… **è‡ªåŠ¨é‡é‡‡æ ·**ï¼šæ—¥å†…æ•°æ®è‡ªåŠ¨è½¬ä¸ºæ—¥æ”¶ç›Šç‡
- âœ… **å…¼å®¹æ€§å¼º**ï¼šé€‚ç”¨äºä»»æ„ backtrader ç­–ç•¥

**ä»£ç ä½ç½®ï¼š** [`Optimizer/backtest_engine.py:80-380`](Optimizer/backtest_engine.py#L80-L380)

---

### åˆ†é’Ÿæ•°æ®å¤„ç†æœºåˆ¶

**é—®é¢˜ï¼š** åˆ†é’Ÿçº§ç­–ç•¥å¦‚ä½•è®¡ç®—å¹´åŒ–æŒ‡æ ‡ï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š** ä¸¤é˜¶æ®µå¤„ç†

#### é˜¶æ®µ1ï¼šæ•°æ®èšåˆ
```python
# backtest_engine.py ç¬¬816-819è¡Œ
is_intraday = _is_intraday_frequency(self.config.data_frequency)
if is_intraday:
    cerebro.addanalyzer(bt.analyzers.TimeReturn, _name='timereturn',
                       timeframe=bt.TimeFrame.Days)
```

**ä½œç”¨ï¼š** åœ¨ backtrader å›æµ‹æ—¶ï¼Œå°†åˆ†é’Ÿçº§æ”¶ç›Šç‡è‡ªåŠ¨èšåˆä¸ºæ—¥æ”¶ç›Šç‡
- å…¬å¼ï¼š`æ—¥æ”¶ç›Š = (1+r1) Ã— (1+r2) Ã— ... Ã— (1+rn) - 1`
- ç¤ºä¾‹ï¼šæŸæ—¥9:30èµš0.1%ï¼Œ10:30äº0.05%ï¼Œ11:30èµš0.2% â†’ æ—¥æ”¶ç›Š = 1.001 Ã— 0.9995 Ã— 1.002 - 1 â‰ˆ 0.25%

#### é˜¶æ®µ2ï¼šå¹´åŒ–è®¡ç®—
```python
# ä½¿ç”¨252ä¸ªäº¤æ˜“æ—¥ä½œä¸ºå¹´åŒ–å› å­
sharpe_ratio = (æ—¥å‡æ”¶ç›Š / æ—¥æ”¶ç›Šæ ‡å‡†å·®) Ã— âˆš252
å¹´åŒ–æ”¶ç›Šç‡ = (1 + æ€»æ”¶ç›Šç‡)^(252/äº¤æ˜“æ—¥æ•°) - 1
```

**ä¸ºä»€ä¹ˆæ˜¯252ï¼Ÿ**
- ç¾è‚¡ä¸€å¹´çº¦252ä¸ªäº¤æ˜“æ—¥
- è¡Œä¸šæ ‡å‡†æƒ¯ä¾‹
- ä¾¿äºä¸åŒé¢‘ç‡ç­–ç•¥å¯¹æ¯”

---

### é…ç½®é€‰é¡¹

åœ¨ [`Optimizer/config.py`](Optimizer/config.py) ä¸­é…ç½®ï¼š

```python
class BacktestConfig:
    initial_cash: float = 100000.0           # åˆå§‹èµ„é‡‘
    commission: float = 0.0002               # æ‰‹ç»­è´¹ç‡
    data_frequency: str = 'daily'            # æ•°æ®é¢‘ç‡: 'daily', '1m', '5m' ç­‰
    
# å¹´åŒ–å› å­é…ç½®ï¼ˆè‡ªåŠ¨ä½¿ç”¨ï¼‰
DATA_FREQUENCY_ANNUALIZATION = {
    '1m': 252,      # åˆ†é’Ÿæ•°æ®èšåˆä¸ºæ—¥åä½¿ç”¨252
    '5m': 252,
    '15m': 252,
    'daily': 252,
    'weekly': 52,
}
```

åœ¨ `BacktestEngine` åˆå§‹åŒ–æ—¶æŒ‡å®šï¼š

```python
engine = BacktestEngine(
    config=config,
    use_trade_log_metrics=True,  # é»˜è®¤Trueï¼Œä¼˜å…ˆä½¿ç”¨trade_log
    data_frequency='1m'           # å£°æ˜æ•°æ®é¢‘ç‡
)
```

---

### ä¸¤ç§æ¨¡å¼å¯¹æ¯”

| ç»´åº¦ | trade_log æ¨¡å¼ | empyrical æ¨¡å¼ |
|------|---------------|---------------|
| **æ•°æ®æ¥æº** | ç­–ç•¥æ‰‹åŠ¨è®°å½•çš„äº¤æ˜“æ—¥å¿— | backtrader æ—¶é—´æ”¶ç›Šç‡åˆ†æå™¨ |
| **è®¡ç®—æ—¶æœº** | ç­–ç•¥è¿è¡Œæ—¶å®æ—¶è®°å½• | å›æµ‹ç»“æŸåè®¡ç®— |
| **ç²¾åº¦** | âœ… åˆ†é’Ÿçº§ç²¾åº¦ | æ—¥çº§æˆ–æ›´ä½é¢‘ |
| **æ‰‹ç»­è´¹** | âœ… ç­–ç•¥æ˜ç¡®è®¡ç®— | ä¾èµ–åˆ†æå™¨è‡ªåŠ¨æå– |
| **æŒ‡æ ‡èŒƒå›´** | åŸºç¡€æŒ‡æ ‡ï¼ˆSharpeã€å›æ’¤ã€èƒœç‡ï¼‰ | âœ… ä¸“ä¸šæŒ‡æ ‡ï¼ˆSortinoã€Calmarã€Omegaç­‰ï¼‰ |
| **é€‚ç”¨ç­–ç•¥** | é«˜é¢‘æ—¥å†…ç­–ç•¥ | é€šç”¨ç­–ç•¥ |
| **æ•°æ®è¦æ±‚** | éœ€ç­–ç•¥ç»´æŠ¤ `trade_log` | æ— ç‰¹æ®Šè¦æ±‚ |
| **è®¡ç®—é€Ÿåº¦** | å¿« | ç¨æ…¢ï¼ˆéœ€empyricalè®¡ç®—ï¼‰ |

---

### éªŒè¯ä¸€è‡´æ€§

å»ºè®®è¿è¡Œä¸€æ¬¡å›æµ‹ï¼Œå¯¹æ¯”ä¸¤ç§æ¨¡å¼çš„ç»“æœï¼š

```python
# æ–¹æ³•1ï¼šä½¿ç”¨ trade_log
engine1 = BacktestEngine(use_trade_log_metrics=True)
result1 = engine1.run_backtest(...)
print(f"trade_log Sharpe: {result1.sharpe_ratio}")

# æ–¹æ³•2ï¼šä½¿ç”¨ empyrical
engine2 = BacktestEngine(use_trade_log_metrics=False)
result2 = engine2.run_backtest(...)
print(f"empyrical Sharpe: {result2.sharpe_ratio}")

# å·®å¼‚åº”å°äº5%
diff = abs(result1.sharpe_ratio - result2.sharpe_ratio) / result1.sharpe_ratio
assert diff < 0.05, "ä¸¤ç§æ¨¡å¼ç»“æœå·®å¼‚è¿‡å¤§ï¼Œéœ€æ£€æŸ¥è®¡ç®—é€»è¾‘"
```

---

## ğŸ“Š æ•°æ®æ ¼å¼è¦æ±‚

### CSVæ–‡ä»¶æ ¼å¼

æ‚¨çš„æ•°æ®CSVæ–‡ä»¶å¿…é¡»åŒ…å«ä»¥ä¸‹åˆ—ï¼ˆåˆ—åä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼š

| åˆ—å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `datetime` æˆ– `date` | æ—¥æœŸæ—¶é—´ | æ—¶é—´æˆ³ | `2024-01-01 09:30:00` |
| `open` | æµ®ç‚¹æ•° | å¼€ç›˜ä»· | `100.5` |
| `high` | æµ®ç‚¹æ•° | æœ€é«˜ä»· | `102.3` |
| `low` | æµ®ç‚¹æ•° | æœ€ä½ä»· | `99.8` |
| `close` | æµ®ç‚¹æ•° | æ”¶ç›˜ä»· | `101.2` |
| `volume` | æ•´æ•° | æˆäº¤é‡ | `1000000` |

### ç¤ºä¾‹CSVæ–‡ä»¶

```csv
date,open,high,low,close,volume
2024-01-01,100.0,102.0,99.0,101.0,1000000
2024-01-02,101.0,103.0,100.5,102.5,1200000
2024-01-03,102.5,104.0,102.0,103.5,1100000
```

**æ³¨æ„ï¼š**
- è„šæœ¬ä¼šè‡ªåŠ¨å°† `date` åˆ—é‡å‘½åä¸º `datetime`
- æ—¥æœŸæ ¼å¼ä¼šè‡ªåŠ¨è§£æ
- æ•°æ®ä¼šè‡ªåŠ¨æŒ‰æ—¶é—´æ’åº

---

## ğŸ“ è¾“å‡ºæ–‡ä»¶

ä¼˜åŒ–å®Œæˆåä¼šåœ¨è¾“å‡ºç›®å½•ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š

```
optimization_results/
â”œâ”€â”€ optimization_BTC_Strategy_20260122_105954.json  # å®Œæ•´JSONç»“æœ
â””â”€â”€ optimization_summary.txt                         # æ˜“è¯»çš„æ–‡æœ¬æ‘˜è¦
```

**JSONæ–‡ä»¶åŒ…å«ï¼š**
- ä¼˜åŒ–ä¿¡æ¯ï¼ˆæ ‡çš„ã€ç­–ç•¥ã€ç›®æ ‡ã€æ—¶é—´ï¼‰
- æœ€ä¼˜å‚æ•°
- æ€§èƒ½æŒ‡æ ‡ï¼ˆå¤æ™®æ¯”ç‡ã€ç´¢æè¯ºæ¯”ç‡ã€å¡ç›æ¯”ç‡ã€å¹´åŒ–æ³¢åŠ¨ç‡ã€Omegaæ¯”ç‡ã€VaRã€å°¾éƒ¨æ¯”ç‡ç­‰ï¼‰ ğŸ†•
- æ¯æ—¥æ”¶ç›Šç‡åºåˆ— ğŸ†•
- é€å¹´è¡¨ç°
- å‚æ•°ç©ºé—´åˆ†æå»ºè®® ğŸ†•
- è¾¹ç•Œæ‰©å±•è®°å½• ğŸ†•

**æ–‡æœ¬æ‘˜è¦åŒ…å«ï¼š**
- æœ€ä¼˜å‚æ•°å€¼
- å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼ˆåŒ…æ‹¬ä¸“ä¸šæŒ‡æ ‡ï¼‰ ğŸ†•
- é€å¹´è¡¨ç°æ‘˜è¦
- ä¼˜åŒ–å»ºè®®

---

## ğŸ”§ ç­–ç•¥è„šæœ¬è¦æ±‚

ç­–ç•¥è„šæœ¬å¿…é¡»ï¼š
1. ç»§æ‰¿è‡ª `backtrader.Strategy`
2. ä½¿ç”¨ `params` å…ƒç»„å®šä¹‰å‚æ•°

### ç®€å•ç¤ºä¾‹

```python
import backtrader as bt

class MyStrategy(bt.Strategy):
    params = (
        ('period', 20),      # æ•´æ•°å‚æ•°
        ('threshold', 0.02), # æµ®ç‚¹å‚æ•°
    )

### é«˜çº§ç¤ºä¾‹ï¼šå¸¦ trade_log çš„ç­–ç•¥ï¼ˆæ¨èç”¨äºé«˜é¢‘ç­–ç•¥ï¼‰

```python
import backtrader as bt

class MyIntradayStrategy(bt.Strategy):
    params = (
        ('period', 20),
        ('threshold', 0.02),
    )
    
    def __init__(self):
        super().__init__()
        # åˆå§‹åŒ–äº¤æ˜“æ—¥å¿—ï¼ˆç”¨äºç²¾ç¡®æŒ‡æ ‡è®¡ç®—ï¼‰
        self.trade_log = []
        self.entry_price = {}
        self.entry_comm = {}
    
    def notify_order(self, order):
        if order.status not in [order.Completed]:
            return
        
        asset = order.data._name
        
        if order.isbuy():
            # è®°å½•ä¹°å…¥ä¿¡æ¯
            self.entry_price[asset] = order.executed.price
            self.entry_comm[asset] = order.executed.comm
            self.entry_time[asset] = self.data.datetime.datetime(0)
        
        elif order.issell():
            # è®¡ç®—æœ¬æ¬¡äº¤æ˜“çš„ç›ˆäº
            entry_p = self.entry_price.get(asset, 0)
            exit_p = order.executed.price
            size = abs(order.executed.size)
            
            # æ€»ç›ˆäº = (å–å‡ºä»· - ä¹°å…¥ä»·) Ã— æ‰‹æ•°
            gross_pnl = (exit_p - entry_p) * size
            
            # å‡€ç›ˆäº = æ€»ç›ˆäº - æ‰‹ç»­è´¹
            entry_comm = self.entry_comm.get(asset, 0)
            exit_comm = order.executed.comm
            net_pnl = gross_pnl - entry_comm - exit_comm
            
            # æ”¶ç›Šç‡ = å‡€ç›ˆäº / (ä¹°å…¥ä»· Ã— æ‰‹æ•°)
            trade_return = (net_pnl / (entry_p * size)) * 100 if entry_p > 0 else 0
            
            # è®°å½•äº¤æ˜“æ—¥å¿—
            self.trade_log.append({
                'entry_datetime': self.entry_time[asset],
                'exit_datetime': self.data.datetime.datetime(0),
                'entry_price': entry_p,
                'exit_price': exit_p,
                'size': size,
                'pnl': net_pnl,
                'return_pct': trade_return,
                'gross_pnl': gross_pnl,
                'commission': entry_comm + exit_comm,
                'final_portfolio_value': self.broker.getvalue()
            })
```

**trade_log å¿…éœ€å­—æ®µï¼š**
- `entry_datetime`: è¿›åœºæ—¶é—´
- `exit_datetime`: å‡ºåœºæ—¶é—´
- `pnl`: å‡€ç›ˆäºï¼ˆå·²æ‰£é™¤æ‰‹ç»­è´¹ï¼‰
- `return_pct`: æ”¶ç›Šç‡ç™¾åˆ†æ¯”ï¼ˆå¯é€‰ï¼Œç”¨äºç»Ÿè®¡ï¼‰
- `final_portfolio_value`: äº¤æ˜“åè´¦æˆ·æ€»å€¼ï¼ˆå¯é€‰ï¼‰
    
    def __init__(self):
        self.sma = bt.indicators.SMA(self.data.close, period=self.params.period)
    
    def next(self):
        if not self.position and self.data.close > self.sma * 1.02:
            self.buy()
        elif self.position and self.data.close < self.sma:
            self.sell()
```

**å‚æ•°å‘½åï¼š** ä½¿ç”¨å°å†™+ä¸‹åˆ’çº¿ï¼Œå¦‚ `fast_period`ã€`stop_loss`

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åªä¼˜åŒ–éƒ¨åˆ†å‚æ•°ï¼Ÿ

åˆ›å»º `params.txt` æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªå‚æ•°åï¼Œç„¶åä½¿ç”¨ `--params-file` å‚æ•°ã€‚

**é€‚ç”¨åœºæ™¯ï¼š** ç­–ç•¥å‚æ•°å¤šï¼ˆ>5ä¸ªï¼‰ã€å·²çŸ¥æŸäº›å‚æ•°åˆç†å€¼ã€åŠ å¿«ä¼˜åŒ–é€Ÿåº¦

### Q2: å‚æ•°ç©ºé—´åˆ†æå»ºè®®å¦‚ä½•ç†è§£ï¼Ÿ

ä¼˜åŒ–åç³»ç»Ÿä¼šæç¤ºå‚æ•°æ˜¯å¦åœ¨è¾¹ç•Œï¼š
- **åœ¨è¾¹ç•Œ** â†’ æ‰©å¤§æœç´¢èŒƒå›´é‡æ–°ä¼˜åŒ–
- **åœ¨ä¸­é—´** â†’ å‚æ•°ç©ºé—´è®¾ç½®åˆç†
- **éƒ½åœ¨è¾¹ç•Œ** â†’ å¯èƒ½ç­–ç•¥é€»è¾‘æœ‰é—®é¢˜

### Q3: ä¼˜åŒ–è¿è¡Œæ…¢æ€ä¹ˆåŠï¼Ÿ

- å‡å°‘è¯•éªŒæ¬¡æ•°ï¼š`--trials 20`
- ä½¿ç”¨å‚æ•°æ–‡ä»¶åªä¼˜åŒ–å…³é”®å‚æ•°
- ä½¿ç”¨é™é»˜æ¨¡å¼ï¼š`--quiet`

### Q4: æ•°æ®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Ÿ

ç¡®ä¿CSVåŒ…å«å¿…éœ€åˆ—ï¼š`datetime/date, open, high, low, close, volume`

åˆ—åä¸åŒæ—¶é¢„å¤„ç†ï¼š
```python
import pandas as pd
df = pd.read_csv('original.csv')
df.rename(columns={'æ—¶é—´': 'datetime', 'å¼€ç›˜': 'open'}, inplace=True)
df.to_csv('processed.csv', index=False)
```

### Q5: å¦‚ä½•æ‰¹é‡ä¼˜åŒ–ï¼Ÿ

**æ–¹æ³•1ï¼šä½¿ç”¨å¤šä¸ªæ–‡ä»¶å‚æ•°ï¼ˆæ¨èï¼‰**
```bash
python run_optimizer.py \
  --data project_trend/data/BTC.csv project_trend/data/ETH.csv project_trend/data/SOL.csv \
  --strategy project_trend/src/strategy.py \
  --trials 50
```

**æ–¹æ³•2ï¼šä½¿ç”¨é€šé…ç¬¦**
```bash
python run_optimizer.py \
  --data project_trend/data/*.csv \
  --strategy project_trend/src/strategy.py \
  --trials 50
```

**æ–¹æ³•3ï¼šä½¿ç”¨shellå¾ªç¯**
```bash
for asset in BTC ETH SOL; do
  python run_optimizer.py -d data/${asset}.csv -s strategy.py -O results/${asset}
done
```

**æ‰¹é‡ä¼˜åŒ–ç‰¹ç‚¹ï¼š**
- âœ… è‡ªåŠ¨ä¸ºæ¯ä¸ªCSVåˆ›å»ºç‹¬ç«‹è¾“å‡ºç›®å½•
- âœ… ç”Ÿæˆç»Ÿä¸€çš„æ‰¹é‡æ‘˜è¦æŠ¥å‘Š
- âœ… å¹¶è¡ŒåŒ–å‚æ•°ä¼˜åŒ–ï¼ˆæ¯ä¸ªæ–‡ä»¶ç‹¬ç«‹ä¼˜åŒ–ï¼‰
- âœ… æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼ˆå•ä¸ªæ–‡ä»¶å¤±è´¥ä¸å½±å“å…¶ä»–ï¼‰

### Q6: æ­£åˆ™è¡¨è¾¾å¼æœä¸åˆ°å‚æ•°æ€ä¹ˆåŠï¼Ÿ

å¦‚æœå‚æ•°åä¸ç¬¦åˆå†…ç½®è§„åˆ™æ¨¡å¼ï¼ˆå¦‚ `custom_param`ã€`param1`ï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨é»˜è®¤è§„åˆ™ï¼ˆ0.5x - 2.0xï¼‰ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
1. **ä½¿ç”¨è‡ªå®šä¹‰å‚æ•°ç©ºé—´é…ç½®ï¼ˆæ¨èï¼‰**ï¼š
   ```bash
   # åˆ›å»ºé…ç½®æ–‡ä»¶ my_space_config.json
   {
       "param_space": {
           "custom_param": {
               "min": 10,
               "max": 100,
               "step": 1,
               "distribution": "int_uniform"
           }
       }
   }
   
   # ä½¿ç”¨é…ç½®
   python run_optimizer.py -d data.csv -s strategy.py --space-config my_space_config.json
   ```

2. **ä¿®æ”¹å‚æ•°å**ï¼šå°†å‚æ•°åæ”¹ä¸ºç¬¦åˆè§„åˆ™çš„æ¨¡å¼ï¼ˆå¦‚ `custom_period` â†’ ä¼šåŒ¹é…å‘¨æœŸè§„åˆ™ï¼‰

3. **ä½¿ç”¨é»˜è®¤è§„åˆ™**ï¼šå¦‚æœé»˜è®¤èŒƒå›´ï¼ˆ0.5x - 2.0xï¼‰å¯ä»¥æ¥å—ï¼Œç›´æ¥ä½¿ç”¨å³å¯

### Q7: åˆ†é’Ÿæ•°æ®çš„å›æµ‹æŒ‡æ ‡ä¸ºä»€ä¹ˆå’Œé¢„æœŸä¸ä¸€æ ·ï¼Ÿ

**å¸¸è§åŸå› ï¼š**
1. **å¹´åŒ–å› å­æ··æ·†**ï¼šåˆ†é’Ÿæ•°æ®èšåˆä¸ºæ—¥æ”¶ç›Šç‡åä½¿ç”¨252å¹´åŒ–ï¼Œè€Œé390Ã—252
2. **æ‰‹ç»­è´¹è®¡ç®—**ï¼štrade_log æ¨¡å¼ä½¿ç”¨ç­–ç•¥æ‰‹åŠ¨è®¡ç®—çš„å‡€ç›ˆäºï¼Œå¯èƒ½ä¸ backtrader è‡ªåŠ¨æå–ä¸åŒ
3. **æ•°æ®èšåˆæ–¹å¼**ï¼šæ—¥å†…å¤šç¬”äº¤æ˜“ä¼šåˆå¹¶ä¸ºä¸€ä¸ªæ—¥æ”¶ç›Šç‡

**è§£å†³æ–¹æ¡ˆï¼š**
```python
# ç¡®ä¿ç­–ç•¥å£°æ˜æ•°æ®é¢‘ç‡
class MyStrategy(bt.Strategy):
    def __init__(self):
        self.data_frequency = '1m'  # æ˜ç¡®å£°æ˜
        
# ç¡®ä¿ BacktestEngine æ­£ç¡®é…ç½®
engine = BacktestEngine(
    data_frequency='1m',           # å£°æ˜æ•°æ®é¢‘ç‡
    use_trade_log_metrics=True     # ä½¿ç”¨ç²¾ç¡®è®¡ç®—
)
```

**éªŒè¯æ–¹æ³•ï¼š**
```python
# æ£€æŸ¥æ—¥å¿—è¾“å‡º
# åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
# "æ£€æµ‹åˆ°æ—¥å†…æ•°æ®é¢‘ç‡: 1mï¼Œä½¿ç”¨æ—¥æ”¶ç›Šç‡èšåˆ"
# "ä½¿ç”¨ trade_log è®¡ç®—æŒ‡æ ‡ï¼Œå…± XXX ç¬”äº¤æ˜“"
```

### Q8: trade_log å’Œ empyrical ä¸¤ç§æ¨¡å¼ç»“æœå·®å¼‚å¤§æ€ä¹ˆåŠï¼Ÿ

**å·®å¼‚åœ¨5%ä»¥å†…**ï¼šæ­£å¸¸ï¼Œä¸¤ç§è®¡ç®—æ–¹å¼ç•¥æœ‰ä¸åŒ
**å·®å¼‚è¶…è¿‡10%**ï¼šéœ€è¦æ’æŸ¥

**æ’æŸ¥æ­¥éª¤ï¼š**
1. **æ£€æŸ¥æ‰‹ç»­è´¹**ï¼š
   ```python
   # trade_log æ¨¡å¼
   net_pnl = gross_pnl - entry_comm - exit_comm
   
   # empyrical æ¨¡å¼ä¾èµ– backtrader è‡ªåŠ¨æå–
   # ç¡®ä¿ä½£é‡‘è®¾ç½®ä¸€è‡´
   ```

2. **æ£€æŸ¥æ—¥æœŸå¯¹é½**ï¼š
   ```python
   # trade_log: æŒ‰ entry_datetime èšåˆ
   df['date'] = pd.to_datetime(df['entry_datetime']).dt.date
   
   # empyrical: ä½¿ç”¨ TimeReturn åˆ†æå™¨çš„æ—¶é—´æˆ³
   # ç¡®ä¿ä¸¤è€…å¯¹é½
   ```

3. **æ£€æŸ¥èµ„äº§æ›²çº¿**ï¼š
   ```python
   # æ‰“å°æ¯æ—¥èµ„äº§å€¼ï¼Œå¯¹æ¯”ä¸¤ç§æ–¹å¼
   print("trade_log èµ„äº§æ›²çº¿:", daily_values)
   print("empyrical èµ„äº§æ›²çº¿:", (1 + daily_returns).cumprod())
   ```

**æ¨èåšæ³•ï¼š**
- é«˜é¢‘ç­–ç•¥ä¼˜å…ˆä½¿ç”¨ trade_log æ¨¡å¼ï¼ˆæ›´ç²¾ç¡®ï¼‰
- æ—¥çº¿ç­–ç•¥ä½¿ç”¨ empyrical æ¨¡å¼ï¼ˆæŒ‡æ ‡æ›´ä¸°å¯Œï¼‰
- å®šæœŸéªŒè¯ä¸¤ç§æ¨¡å¼çš„ä¸€è‡´æ€§

---


## ğŸ“ æœ€ä½³å®è·µ

### 1. æ•°æ®å‡†å¤‡

- âœ… ç¡®ä¿æ•°æ®å®Œæ•´ã€æ— ç¼ºå¤±å€¼
- âœ… æ•°æ®æŒ‰æ—¶é—´æ­£åºæ’åˆ—
- âœ… æ£€æŸ¥å¼‚å¸¸å€¼å’Œé”™è¯¯æ•°æ®ç‚¹
- âœ… ä½¿ç”¨è¶³å¤Ÿé•¿çš„å†å²æ•°æ®ï¼ˆè‡³å°‘2å¹´ï¼‰

### 2. å‚æ•°è®¾ç½®

- âœ… ä»è¾ƒå°‘çš„è¯•éªŒæ¬¡æ•°å¼€å§‹ï¼ˆ20-50æ¬¡ï¼‰
- âœ… æ ¹æ®åˆæ­¥ç»“æœè°ƒæ•´è¯•éªŒæ¬¡æ•°
- âœ… é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç›®æ ‡ï¼ˆé€šå¸¸ç”¨å¤æ™®æ¯”ç‡ï¼‰
- âœ… å¯¹äºå¿«é€Ÿæµ‹è¯•ä½¿ç”¨ `--quiet` æ¨¡å¼
- âœ… ç­–ç•¥å‚æ•°å¤šï¼ˆ>5ä¸ªï¼‰æ—¶ï¼Œè€ƒè™‘ä½¿ç”¨ `--params-file` åªä¼˜åŒ–å…³é”®å‚æ•°
- âœ… ä¼˜å…ˆä¼˜åŒ–å¯¹ç­–ç•¥å½±å“å¤§çš„å‚æ•°ï¼ˆå¦‚å‘¨æœŸã€é˜ˆå€¼ï¼‰
- âœ… **ä¿¡ä»»è‡ªåŠ¨è¾¹ç•Œæ‰©å±•**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ‰©å±•è¾¹ç•Œï¼Œæ— éœ€æ‰‹åŠ¨é‡æ–°ä¼˜åŒ–
- âœ… **å…³æ³¨Trial 0ç»“æœ**ï¼šè¿™æ˜¯ç­–ç•¥é»˜è®¤å‚æ•°çš„è¡¨ç°ï¼Œä½œä¸ºä¼˜åŒ–åŸºå‡†

### 3. æ‰¹é‡ä¼˜åŒ–å»ºè®® ğŸ†•

- âœ… ä½¿ç”¨å¤šæ–‡ä»¶å‚æ•°æ‰¹é‡ä¼˜åŒ–å¤šä¸ªæ ‡çš„
- âœ… ä¸ºæ¯ä¸ªæ ‡çš„è®¾ç½®ç‹¬ç«‹è¾“å‡ºç›®å½•
- âœ… ä½¿ç”¨é€šé…ç¬¦ç®€åŒ–å‘½ä»¤è¡Œè¾“å…¥
- âœ… æ£€æŸ¥æ‰¹é‡æ‘˜è¦æŠ¥å‘Šäº†è§£æ•´ä½“è¡¨ç°

### 4. ç»“æœéªŒè¯

- âœ… æ£€æŸ¥å¹´åº¦è¡¨ç°çš„ç¨³å®šæ€§
- âœ… å…³æ³¨äº¤æ˜“æ¬¡æ•°ï¼ˆè¿‡å°‘æˆ–è¿‡å¤šéƒ½ä¸å¥½ï¼‰
- âœ… æ³¨æ„è¿‡æ‹Ÿåˆé£é™©ï¼ˆè¿‡äºå®Œç¾çš„ç»“æœï¼‰
- âœ… åœ¨æ ·æœ¬å¤–æ•°æ®ä¸ŠéªŒè¯ç»“æœ
- âœ… è€ƒè™‘å®é™…äº¤æ˜“æˆæœ¬å’Œæ»‘ç‚¹
- âœ… **å¯¹æ¯”ä¸“ä¸šæŒ‡æ ‡**ï¼šä½¿ç”¨Sortinoã€Calmarã€Omegaç­‰æŒ‡æ ‡ç»¼åˆè¯„ä¼°
- âœ… **å…³æ³¨VaRå’Œå°¾éƒ¨é£é™©**ï¼šè¯„ä¼°æç«¯å¸‚åœºæ¡ä»¶ä¸‹çš„è¡¨ç°
- âœ… **éªŒè¯è¾¹ç•Œæ‰©å±•**ï¼šæ£€æŸ¥æ˜¯å¦æœ‰å‚æ•°ç»å†äº†è¾¹ç•Œæ‰©å±•

### 5. å›æµ‹æŒ‡æ ‡è®¡ç®—å»ºè®® ğŸ†•

#### é«˜é¢‘ç­–ç•¥ï¼ˆåˆ†é’Ÿçº§ï¼‰
- âœ… **æ¨èä½¿ç”¨ trade_log æ¨¡å¼**ï¼šåœ¨ç­–ç•¥ä¸­ç»´æŠ¤ `self.trade_log`
- âœ… **æ‰‹åŠ¨è®¡ç®—PNL**ï¼šåœ¨ `notify_order()` ä¸­ç²¾ç¡®è®¡ç®—å‡€ç›ˆäº
- âœ… **è®°å½•å®Œæ•´ä¿¡æ¯**ï¼šåŒ…æ‹¬è¿›å‡ºåœºæ—¶é—´ã€ä»·æ ¼ã€æ‰‹ç»­è´¹
- âœ… **è®¾ç½®æ•°æ®é¢‘ç‡**ï¼šåœ¨é…ç½®ä¸­å£°æ˜ `data_frequency='1m'`
- âœ… **éªŒè¯èšåˆç»“æœ**ï¼šæ£€æŸ¥æ—¥æ”¶ç›Šç‡æ˜¯å¦åˆç†

**ç¤ºä¾‹ï¼šåˆ†é’Ÿç­–ç•¥çš„ trade_log å®ç°**
```python
def notify_order(self, order):
    if order.status == order.Completed:
        if order.issell():
            # è®¡ç®—å‡€ç›ˆäºï¼ˆå·²æ‰£é™¤æ‰‹ç»­è´¹ï¼‰
            net_pnl = gross_pnl - entry_comm - exit_comm
            
            # è®°å½•åˆ° trade_log
            self.trade_log.append({
                'entry_datetime': entry_time,
                'exit_datetime': self.data.datetime.datetime(0),
                'pnl': net_pnl,
                'return_pct': net_pnl / cost * 100,
                'final_portfolio_value': self.broker.getvalue()
            })
```

#### æ—¥çº¿ç­–ç•¥
- âœ… **å¯ä½¿ç”¨ empyrical æ¨¡å¼**ï¼šæ— éœ€ç»´æŠ¤ trade_log
- âœ… **äº«å—ä¸“ä¸šæŒ‡æ ‡**ï¼šè‡ªåŠ¨è·å¾— Sortinoã€Calmar ç­‰æŒ‡æ ‡
- âœ… **ç®€åŒ–ç­–ç•¥ä»£ç **ï¼šä¸“æ³¨äº¤æ˜“é€»è¾‘ï¼Œä¸éœ€è¦é¢å¤–è®°å½•

#### å¯¹æ¯”éªŒè¯ï¼ˆæ¨èï¼‰
```bash
# ç¬¬ä¸€æ¬¡è¿è¡Œï¼šä½¿ç”¨ trade_logï¼ˆå¦‚æœç­–ç•¥æ”¯æŒï¼‰
python run_optimizer.py -d data.csv -s strategy.py --trials 10

# æ£€æŸ¥è¾“å‡ºçš„ sharpe_ratio å’Œ annual_return

# ï¼ˆå¯é€‰ï¼‰ä¿®æ”¹ç­–ç•¥ç§»é™¤ trade_logï¼Œå†æ¬¡è¿è¡Œå¯¹æ¯”
# ä¸¤æ¬¡ç»“æœå·®å¼‚åº”å°äº5%
```

### 6. LLMä½¿ç”¨å»ºè®®

- âœ… ä»…åœ¨å‚æ•°ç©ºé—´å¤æ‚æ—¶ä½¿ç”¨LLM
- âœ… æœ¬åœ°Ollamaé€‚åˆé¢‘ç¹ä½¿ç”¨
- âœ… OpenAI APIé€‚åˆé«˜è´¨é‡åˆ†æä½†æˆæœ¬è¾ƒé«˜
- âœ… å¢åŠ è¶…æ—¶æ—¶é—´é¿å…è¿æ¥é—®é¢˜

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯

```bash
python run_optimizer.py --help
```

### è°ƒè¯•æ¨¡å¼

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œç§»é™¤ `--quiet` å‚æ•°ä»¥æŸ¥çœ‹è¯¦ç»†è¾“å‡ºï¼š

```bash
python run_optimizer.py -d data.csv -s strategy.py
```

### ç›¸å…³æ–‡æ¡£

- [å‚æ•°ç©ºé—´ä¼˜åŒ–æŒ‡å—](å‚æ•°ç©ºé—´ä¼˜åŒ–æŒ‡å—.md) ğŸ†•
- [Optimizeræ¨¡å—æ€»è§ˆ](Optimizer/é¡¹ç›®æ€»è§ˆ.md)
- [é€šç”¨ä¼˜åŒ–å™¨æŒ‡å—](Optimizer/UNIVERSAL_OPTIMIZER_GUIDE.md)
- [Backtraderå®˜æ–¹æ–‡æ¡£](https://www.backtrader.com/docu/)

---

## ğŸ§  æ™ºèƒ½å‚æ•°ç©ºé—´ä¸ä¼˜åŒ–åŸç†

### 1. å‚æ•°ä¼˜åŒ–æµç¨‹

ç³»ç»Ÿé‡‡ç”¨**è‡ªé€‚åº”å‚æ•°ç©ºé—´ä¼˜åŒ–**æœºåˆ¶ï¼Œè‡ªåŠ¨è°ƒæ•´æœç´¢èŒƒå›´ä»¥æ‰¾åˆ°æœ€ä¼˜å‚æ•°ã€‚

#### ğŸ“Š å®Œæ•´ä¼˜åŒ–æµç¨‹å›¾

```mermaid
graph TD
    A[å¼€å§‹ä¼˜åŒ–] --> B[æå–ç­–ç•¥å‚æ•°]
    B --> C[ç”Ÿæˆåˆå§‹å‚æ•°ç©ºé—´<br/>Â±30%èŒƒå›´]
    C --> D[æ·»åŠ é»˜è®¤å‚æ•°<br/>ä½œä¸ºTrial 0]
    D --> E[æ‰§è¡Œè´å¶æ–¯ä¼˜åŒ–<br/>TPEç®—æ³•]
    E --> F[æ£€æŸ¥æœ€ä¼˜å‚æ•°ä½ç½®]
    
    F --> G{å‚æ•°åœ¨è¾¹ç•Œ?<br/>threshold=10%}
    G -->|æ˜¯| H[è®°å½•è¾¹ç•Œå‚æ•°]
    G -->|å¦| M[ä¼˜åŒ–å®Œæˆ]
    
    H --> I{æ‰©å±•æ¬¡æ•°<2è½®?}
    I -->|æ˜¯| J[æ‰©å±•è¾¹ç•Œå‚æ•°<br/>Ã—1.5å€]
    I -->|å¦| M
    
    J --> K[æ›´æ–°å‚æ•°ç©ºé—´]
    K --> L[ç»§ç»­ä¼˜åŒ–<br/>é¢å¤–20æ¬¡è¯•éªŒ]
    L --> F
    
    M --> N[ç”Ÿæˆä¼˜åŒ–æŠ¥å‘Š]
    N --> O[è¾“å‡ºç»“æœ]
    
    style D fill:#e1f5ff
    style G fill:#fff4e1
    style J fill:#ffe1e1
    style M fill:#e1ffe1
```

#### ğŸ”„ ä¼˜åŒ–é˜¶æ®µè¯¦è§£

**é˜¶æ®µ 1ï¼šåˆå§‹åŒ–ï¼ˆTrial 0ï¼‰**
```
ç­–ç•¥é»˜è®¤å‚æ•° â†’ ä½œä¸ºé¦–ä¸ªè¯•éªŒç‚¹
ç›®çš„ï¼šç¡®ä¿ä¸é—æ¼ç­–ç•¥åŸå§‹è®¾å®šçš„æ€§èƒ½
ç¤ºä¾‹ï¼šperiod=20, devfactor=2.0 â†’ Sharpe=0.45
```

**é˜¶æ®µ 2ï¼šåˆå§‹å‚æ•°ç©ºé—´ç”Ÿæˆï¼ˆÂ±30%ï¼‰**
```
å‚æ•°ç±»å‹è¯†åˆ« â†’ åº”ç”¨å†…ç½®è§„åˆ™ â†’ ç”Ÿæˆæœç´¢èŒƒå›´

ç¤ºä¾‹ï¼š
  period = 20 (å‘¨æœŸç±»)
    â†’ èŒƒå›´ï¼š[20Ã—0.7, 20Ã—1.3] = [14, 26]
  
  devfactor = 2.0 (æ ‡å‡†å·®å€æ•°)
    â†’ èŒƒå›´ï¼š[2.0Ã—0.7, 2.0Ã—1.3] = [1.4, 2.6]
```

**é˜¶æ®µ 3ï¼šè´å¶æ–¯ä¼˜åŒ–ï¼ˆTPEç®—æ³•ï¼‰**
```
Trial 1-10ï¼šéšæœºæ¢ç´¢
  â†’ åœ¨å‚æ•°ç©ºé—´å‡åŒ€é‡‡æ ·ï¼Œå»ºç«‹åˆå§‹æ¨¡å‹

Trial 11+ï¼šæ™ºèƒ½é‡‡æ ·
  â†’ åŸºäºå†å²è¡¨ç°ï¼Œé›†ä¸­æœç´¢é«˜ä»·å€¼åŒºåŸŸ
  â†’ ä½¿ç”¨æ¦‚ç‡æ¨¡å‹é¢„æµ‹æœ€ä¼˜å‚æ•°ä½ç½®
```

**é˜¶æ®µ 4ï¼šè¾¹ç•Œæ£€æµ‹**
```
ä¼˜åŒ–å®Œæˆ â†’ æ£€æŸ¥æœ€ä¼˜å‚æ•°ä½ç½®

è¾¹ç•Œåˆ¤å®šï¼š
  distance_to_min = (value - min) / (max - min)
  distance_to_max = (max - value) / (max - min)
  
  if distance_to_min < 0.1 or distance_to_max < 0.1:
      å‚æ•°åœ¨è¾¹ç•Œ â†’ éœ€è¦æ‰©å±•
```

**é˜¶æ®µ 5ï¼šè‡ªåŠ¨è¾¹ç•Œæ‰©å±•**
```
æ£€æµ‹åˆ°è¾¹ç•Œå‚æ•° â†’ æ‰©å±•æœç´¢èŒƒå›´

æ‰©å±•ç­–ç•¥ï¼š
  if å‚æ•°åœ¨ä¸‹ç•Œ:
      new_min = current_min / 1.5
  if å‚æ•°åœ¨ä¸Šç•Œ:
      new_max = current_max Ã— 1.5

ç¤ºä¾‹ï¼š
  period = 25 (èŒƒå›´[14,26]ï¼Œæ¥è¿‘ä¸Šç•Œ)
    â†’ æ‰©å±•ï¼š[14, 39]  (26Ã—1.5)
  
  ç»§ç»­ä¼˜åŒ– 20 æ¬¡è¯•éªŒ
    â†’ æ–°æœ€ä¼˜ï¼šperiod = 35
```

**é˜¶æ®µ 6ï¼šè¿­ä»£ä¼˜åŒ–**
```
å¾ªç¯ï¼šè¾¹ç•Œæ£€æµ‹ â†’ æ‰©å±• â†’ ä¼˜åŒ–
æœ€å¤šæ‰©å±• 2 è½®ï¼ˆé¿å…æ— é™æ‰©å±•ï¼‰

é€€å‡ºæ¡ä»¶ï¼š
  1. æœ€ä¼˜å‚æ•°ä¸åœ¨è¾¹ç•Œ
  2. å·²æ‰©å±• 2 è½®
  3. å‚æ•°ç©ºé—´æ”¶æ•›
```

### 2. å‚æ•°ç©ºé—´ç¡®å®šæ–¹æ³•

ç³»ç»Ÿä½¿ç”¨**æ™ºèƒ½è§„åˆ™åŒ¹é…**è‡ªåŠ¨ç¡®å®šå‚æ•°çš„æœç´¢èŒƒå›´ï¼š

#### ğŸ” å‚æ•°è¯†åˆ«æµç¨‹

```
ç­–ç•¥å‚æ•° â†’ æå–å‚æ•°åå’Œé»˜è®¤å€¼ â†’ è§„åˆ™åŒ¹é… â†’ è®¡ç®—æœç´¢èŒƒå›´
```

**è®¡ç®—å…¬å¼ï¼š**
```
min_value = max(é»˜è®¤å€¼ Ã— min_multiplier, min_absolute)
max_value = min(é»˜è®¤å€¼ Ã— max_multiplier, max_absolute)

åˆå§‹èŒƒå›´ï¼š
  - min_multiplier = 0.7  (åŸå€¼çš„70%)
  - max_multiplier = 1.3  (åŸå€¼çš„130%)

è¾¹ç•Œæ‰©å±•ï¼š
  - expansion_factor = 1.5  (æ‰©å±•1.5å€)
  - max_rounds = 2  (æœ€å¤šæ‰©å±•2è½®)
```

#### ğŸ“Š å†…ç½®è¯†åˆ«è§„åˆ™

| å‚æ•°ç±»å‹ | è¯†åˆ«æ¨¡å¼ | åˆå§‹èŒƒå›´ | ç»å¯¹è¾¹ç•Œ | ç¤ºä¾‹ |
|---------|---------|---------|---------|------|
| å‘¨æœŸå‚æ•° | `period`, `window`, `length` | 0.7x ~ 1.3x | [5, 200] | `period=20` â†’ [14, 26] |
| æ ‡å‡†å·®å€æ•° | `std`, `devfactor` | 0.7x ~ 1.3x | [0.5, 5.0] | `devfactor=2.0` â†’ [1.4, 2.6] |
| å¿«é€Ÿå‘¨æœŸ | `fast`, `short` | 0.7x ~ 1.3x | [3, 50] | `fast_period=10` â†’ [7, 13] |
| æ…¢é€Ÿå‘¨æœŸ | `slow`, `long` | 0.7x ~ 1.3x | [10, 200] | `slow_period=30` â†’ [21, 39] |
| RSIé˜ˆå€¼ | `rsi.*sold`, `rsi.*bought` | 0.7x ~ 1.3x | [10, 90] | `rsi_oversold=30` â†’ [21, 39] |
| é˜ˆå€¼ç±» | `threshold`, `limit` | 0.7x ~ 1.3x | [0.01, 0.5] | `threshold=0.05` â†’ [0.035, 0.065] |
| æœªè¯†åˆ«å‚æ•° | - | 0.7x ~ 1.3x | int: [1, âˆ] / float: [0.0001, âˆ] | `custom=100` â†’ [70, 130] |

#### ğŸ” å‚æ•°å½’ç±»æœºåˆ¶

ç³»ç»Ÿé€šè¿‡**æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‚æ•°åç§°**è‡ªåŠ¨å°†å‚æ•°å½’ç±»åˆ°å¯¹åº”çš„è§„åˆ™ï¼š

**å½’ç±»æµç¨‹ï¼š**
```
æå–å‚æ•°å â†’ éå†æ‰€æœ‰è§„åˆ™ â†’ æ­£åˆ™åŒ¹é… â†’ åº”ç”¨ç¬¬ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™
```

**åŒ¹é…ç®—æ³•ï¼š**
```python
# å¯¹æ¯ä¸ªå‚æ•°ï¼Œéå†æ‰€æœ‰å†…ç½®è§„åˆ™
for rule_name, rule in BUILTIN_RULES.items():
    if re.search(rule.param_pattern, param.name, re.IGNORECASE):
        # æ‰¾åˆ°åŒ¹é…çš„è§„åˆ™ï¼Œåº”ç”¨è¯¥è§„åˆ™
        matched_rule = rule
        break
```

**æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼è¯´æ˜ï¼š**

| è§„åˆ™ç±»å‹ | æ­£åˆ™æ¨¡å¼ | åŒ¹é…é€»è¾‘ | åŒ¹é…ç¤ºä¾‹ |
|---------|---------|---------|---------|
| å‘¨æœŸç±» | `.*period.*\|.*window.*\|.*length.*` | å‚æ•°ååŒ…å« "period"ã€"window" æˆ– "length" | `period`, `ma_period`, `window_size`, `lookback_length` |
| æ ‡å‡†å·® | `.*std.*\|.*dev.*factor.*` | åŒ…å« "std" æˆ– "dev"+"factor" | `std_dev`, `devfactor`, `stddev`, `dev_factor` |
| å¿«é€Ÿå‘¨æœŸ | `.*fast.*\|.*short.*` | åŒ…å« "fast" æˆ– "short" | `fast_period`, `short_ma`, `fast_window` |
| æ…¢é€Ÿå‘¨æœŸ | `.*slow.*\|.*long.*` | åŒ…å« "slow" æˆ– "long" | `slow_period`, `long_ma`, `slow_window` |
| RSIé˜ˆå€¼ | `.*rsi.*sold.*\|.*rsi.*bought.*` | åŒ…å« "rsi"+"sold" æˆ– "rsi"+"bought" | `rsi_oversold`, `rsi_overbought` |
| æ­¢æŸ | `.*stop.*loss.*\|.*sl.*` | åŒ…å« "stop"+"loss" æˆ– "sl" | `stop_loss`, `stopLoss`, `sl_percent` |
| æ­¢ç›ˆ | `.*take.*profit.*\|.*tp.*` | åŒ…å« "take"+"profit" æˆ– "tp" | `take_profit`, `takeProfit`, `tp_percent` |

**å…³é”®ç‰¹æ€§ï¼š**
- âœ… **å¤§å°å†™ä¸æ•æ„Ÿ**ï¼šä½¿ç”¨ `re.IGNORECASE` æ ‡å¿—ï¼Œ`Period`ã€`PERIOD`ã€`period` éƒ½èƒ½åŒ¹é…
- âœ… **éƒ¨åˆ†åŒ¹é…**ï¼šåªè¦å‚æ•°ååŒ…å«å…³é”®è¯å³å¯ï¼Œå¦‚ `ma_period` ä¼šåŒ¹é…å‘¨æœŸç±»è§„åˆ™
- âœ… **ç¬¬ä¸€ä¸ªåŒ¹é…ä¼˜å…ˆ**ï¼šå¦‚æœå‚æ•°ååŒæ—¶åŒ¹é…å¤šä¸ªè§„åˆ™ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™
- âœ… **æœªåŒ¹é…ä½¿ç”¨é»˜è®¤**ï¼šå¦‚æœæ‰€æœ‰è§„åˆ™éƒ½ä¸åŒ¹é…ï¼Œä½¿ç”¨ä¿å®ˆçš„é»˜è®¤è§„åˆ™ï¼ˆ0.7x - 1.3xï¼‰

### 3. è‡ªåŠ¨è¾¹ç•Œæ‰©å±•æœºåˆ¶ ğŸ†•

å½“ä¼˜åŒ–ç»“æœæ˜¾ç¤ºå‚æ•°åœ¨æœç´¢èŒƒå›´è¾¹ç•Œæ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨æ‰©å±•æœç´¢ç©ºé—´ã€‚

#### ğŸ“ˆ è¾¹ç•Œæ‰©å±•æµç¨‹

```
ä¼˜åŒ–å®Œæˆ â†’ åˆ†ææœ€ä¼˜å‚æ•°ä½ç½®
              â†“
    è®¡ç®—è·ç¦»è¾¹ç•Œçš„ç›¸å¯¹è·ç¦»
              â†“
    distance < 10% ?
         â†™        â†˜
       æ˜¯          å¦
       â†“           â†“
    æ‰©å±•èŒƒå›´    ä¼˜åŒ–å®Œæˆ
    Ã—1.5å€
       â†“
  ç»§ç»­ä¼˜åŒ–20æ¬¡
       â†“
    é‡æ–°æ£€æµ‹
```

#### ğŸ” è¾¹ç•Œæ£€æµ‹ç®—æ³•

```python
def check_boundary(param_value, min_val, max_val):
    """
    æ£€æµ‹å‚æ•°æ˜¯å¦åœ¨è¾¹ç•Œ
    threshold = 0.1 (10%)
    """
    range_size = max_val - min_val
    distance_to_min = (param_value - min_val) / range_size
    distance_to_max = (max_val - param_value) / range_size
    
    return distance_to_min < 0.1 or distance_to_max < 0.1
```

#### ğŸ“Š æ‰©å±•ç­–ç•¥

| è¾¹ç•Œç±»å‹ | æ‰©å±•æ–¹å¼ | ç¤ºä¾‹ |
|---------|---------|------|
| ä¸‹è¾¹ç•Œ | `new_min = current_min / 1.5` | `[14, 26]` â†’ `[9.3, 26]` |
| ä¸Šè¾¹ç•Œ | `new_max = current_max Ã— 1.5` | `[14, 26]` â†’ `[14, 39]` |
| åŒè¾¹ç•Œ | åŒæ—¶æ‰©å±•ä¸¤ä¾§ | `[14, 26]` â†’ `[9.3, 39]` |

**æ‰©å±•é™åˆ¶ï¼š**
- æœ€å¤šæ‰©å±• **2 è½®**
- æ¯è½®é¢å¤–ä¼˜åŒ– **20 æ¬¡**è¯•éªŒ
- å—ç»å¯¹è¾¹ç•Œçº¦æŸï¼ˆå¦‚å‘¨æœŸå‚æ•° [5, 200]ï¼‰

#### ğŸ’¡ å®é™…æ¡ˆä¾‹ï¼šAG ç­–ç•¥ä¼˜åŒ–

```
ã€ç¬¬1è½®ä¼˜åŒ–ã€‘50æ¬¡è¯•éªŒ
  åˆå§‹èŒƒå›´ï¼šbband_period [14, 26]
  æœ€ä¼˜ç»“æœï¼šbband_period = 25 (æ¥è¿‘ä¸Šç•Œ)
  Sharpe = 0.2822
  
  â†’ æ£€æµ‹åˆ°ä¸Šè¾¹ç•Œ â†’ è‡ªåŠ¨æ‰©å±•

ã€ç¬¬2è½®ä¼˜åŒ–ã€‘+20æ¬¡è¯•éªŒ
  æ‰©å±•èŒƒå›´ï¼šbband_period [14, 39]
  æœ€ä¼˜ç»“æœï¼šbband_period = 30
            init_exit_period = 54 (æ¥è¿‘ä¸Šç•Œ)
  Sharpe = 0.2954 (+4.7%)
  
  â†’ æ£€æµ‹åˆ°æ–°è¾¹ç•Œ â†’ ç»§ç»­æ‰©å±•

ã€ç¬¬3è½®ä¼˜åŒ–ã€‘+20æ¬¡è¯•éªŒ  
  æ‰©å±•èŒƒå›´ï¼šinit_exit_period [36, 81]
  æœ€ä¼˜ç»“æœï¼šbband_period = 33
            init_exit_period = 62
  Sharpe = 0.3019 (+2.2%)
  
  â†’ å‚æ•°ä¸åœ¨è¾¹ç•Œ â†’ ä¼˜åŒ–å®Œæˆ

æ€»è®¡è¯•éªŒï¼š50 + 20 + 20 = 90æ¬¡
æ€§èƒ½æå‡ï¼š7.0% (0.2822 â†’ 0.3019)
```

#### âš™ï¸ é…ç½®å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `boundary_threshold` | `0.1` | è¾¹ç•Œåˆ¤å®šé˜ˆå€¼ï¼ˆ10%ï¼‰ |
| `expansion_factor` | `1.5` | æ‰©å±•å€æ•° |
| `max_expansion_rounds` | `2` | æœ€å¤§æ‰©å±•è½®æ•° |
| `trials_per_round` | `20` | æ¯è½®é¢å¤–è¯•éªŒæ¬¡æ•° |

### 4. é»˜è®¤å‚æ•°é‡‡æ ·æœºåˆ¶ ğŸ†•

ä¼˜åŒ–é¦–ä¸ªè¯•éªŒï¼ˆTrial 0ï¼‰ä½¿ç”¨ç­–ç•¥é»˜è®¤å‚æ•°ï¼Œç¡®ä¿ä¸é—æ¼åŸå§‹è®¾å®šã€‚

#### ğŸ¯ å®ç°åŸç†

```python
# æå–ç­–ç•¥é»˜è®¤å‚æ•°
default_params = {
    'period': 20,
    'devfactor': 2.0,
    'stop_loss': 0.05
}

# åŠ å…¥ä¼˜åŒ–é˜Ÿåˆ—ï¼ˆTrial 0ï¼‰
study.enqueue_trial(default_params)

# åç»­ä½¿ç”¨TPEç®—æ³•é‡‡æ ·
# Trial 1-10: éšæœºæ¢ç´¢
# Trial 11+: æ™ºèƒ½é‡‡æ ·
```

#### ğŸ“Š é‡‡æ ·åºåˆ—ç¤ºä¾‹

```
Trial 0: é»˜è®¤å‚æ•° {period: 20, devfactor: 2.0}
         â†’ Sharpe = 0.52

Trial 1: éšæœºé‡‡æ · {period: 15, devfactor: 1.8}
         â†’ Sharpe = 0.48

Trial 2: éšæœºé‡‡æ · {period: 25, devfactor: 2.4}
         â†’ Sharpe = 0.61

...

Trial 11: TPEå»ºè®® {period: 24, devfactor: 2.3}
          â†’ Sharpe = 0.68
```

**ä¼˜åŠ¿ï¼š**
- âœ… é¿å…é—æ¼ç­–ç•¥ä½œè€…ç²¾å¿ƒè®¾å®šçš„å‚æ•°
- âœ… æä¾›æ€§èƒ½åŸºå‡†ï¼ˆbaselineï¼‰
- âœ… éªŒè¯ä¼˜åŒ–æ˜¯å¦æœ‰å®é™…æå‡

### 5. ä¸“ä¸šæŒ‡æ ‡è®¡ç®—æ¡†æ¶ ğŸ†•

ç³»ç»Ÿä½¿ç”¨ **pyfolio/empyrical** æ¡†æ¶è®¡ç®—ä¸“ä¸šé‡‘èæŒ‡æ ‡ã€‚

#### ğŸ“Š æ”¯æŒçš„æŒ‡æ ‡

| æŒ‡æ ‡ç±»åˆ« | æŒ‡æ ‡åç§° | è¯´æ˜ | è®¡ç®—æ¡†æ¶ |
|---------|---------|------|---------|
| é£é™©è°ƒæ•´æ”¶ç›Š | Sharpe Ratio | è¶…é¢æ”¶ç›Š/æ³¢åŠ¨ç‡ | empyrical |
| é£é™©è°ƒæ•´æ”¶ç›Š | Sortino Ratio | è¶…é¢æ”¶ç›Š/ä¸‹è¡Œæ³¢åŠ¨ç‡ | empyrical |
| é£é™©è°ƒæ•´æ”¶ç›Š | Calmar Ratio | å¹´åŒ–æ”¶ç›Š/æœ€å¤§å›æ’¤ | empyrical |
| é«˜é˜¶æŒ‡æ ‡ | Omega Ratio | æ”¶ç›Šæ¦‚ç‡/æŸå¤±æ¦‚ç‡ | empyrical |
| é£é™©æŒ‡æ ‡ | Value at Risk (VaR) | 95%ç½®ä¿¡åº¦æœ€å¤§æŸå¤± | empyrical |
| é£é™©æŒ‡æ ‡ | Annual Volatility | å¹´åŒ–æ³¢åŠ¨ç‡ | empyrical |
| å°¾éƒ¨é£é™© | Tail Ratio | å³å°¾/å·¦å°¾æ¯”ç‡ | empyrical |
| æ”¶ç›ŠæŒ‡æ ‡ | Annual Return | å¹´åŒ–æ”¶ç›Šç‡ | empyrical |
| é£é™©æŒ‡æ ‡ | Max Drawdown | æœ€å¤§å›æ’¤ | empyrical |

#### ğŸ”§ è®¡ç®—æµç¨‹

```
å›æµ‹æ‰§è¡Œ â†’ æå–æ¯æ—¥æ”¶ç›Šç‡åºåˆ—
           â†“
    empyrical.sharpe_ratio(returns)
    empyrical.sortino_ratio(returns)
    empyrical.calmar_ratio(returns)
    empyrical.omega_ratio(returns)
    empyrical.value_at_risk(returns)
           â†“
    ç”Ÿæˆå®Œæ•´æ€§èƒ½æŒ‡æ ‡
```

**ç¤ºä¾‹è¾“å‡ºï¼š**
```json
{
    "sharpe_ratio": 0.8923,
    "sortino_ratio": 1.2341,
    "calmar_ratio": 0.6721,
    "omega_ratio": 1.1567,
    "annual_volatility": 0.1523,
    "value_at_risk": -0.0234,
    "tail_ratio": 1.0891,
    "annual_return": 0.1356,
    "max_drawdown": -0.2018
}
```

**å½’ç±»ç¤ºä¾‹ï¼š**

```
å‚æ•°å: "period"
  â†’ åŒ¹é…è§„åˆ™ "period" (.*period.*) âœ“
  â†’ å½’ç±»ï¼šå‘¨æœŸç±»
  â†’ åº”ç”¨èŒƒå›´ï¼š[é»˜è®¤å€¼Ã—0.5, é»˜è®¤å€¼Ã—2.5]ï¼Œé™åˆ¶[5, 200]

å‚æ•°å: "devfactor"
  â†’ åŒ¹é…è§„åˆ™ "std_dev" (.*dev.*factor.*) âœ“
  â†’ å½’ç±»ï¼šæ ‡å‡†å·®å€æ•°
  â†’ åº”ç”¨èŒƒå›´ï¼š[é»˜è®¤å€¼Ã—0.5, é»˜è®¤å€¼Ã—2.0]ï¼Œé™åˆ¶[0.5, 5.0]

å‚æ•°å: "fast_ma"
  â†’ åŒ¹é…è§„åˆ™ "fast_period" (.*fast.*) âœ“
  â†’ å½’ç±»ï¼šå¿«é€Ÿå‘¨æœŸ
  â†’ åº”ç”¨èŒƒå›´ï¼š[é»˜è®¤å€¼Ã—0.5, é»˜è®¤å€¼Ã—2.0]ï¼Œé™åˆ¶[3, 50]

å‚æ•°å: "custom_param"
  â†’ æ‰€æœ‰è§„åˆ™éƒ½ä¸åŒ¹é… âœ—
  â†’ å½’ç±»ï¼šæœªè¯†åˆ«ï¼ˆä½¿ç”¨é»˜è®¤è§„åˆ™ï¼‰
  â†’ åº”ç”¨èŒƒå›´ï¼š[é»˜è®¤å€¼Ã—0.5, é»˜è®¤å€¼Ã—2.0]
```

**å®é™…å½’ç±»è¿‡ç¨‹æ¼”ç¤ºï¼š**

å‡è®¾ç­–ç•¥æœ‰ä»¥ä¸‹å‚æ•°ï¼š
```python
ç­–ç•¥å‚æ•°:
  - period = 20
  - devfactor = 2.0
  - fast_ma = 10
  - slow_ma = 30
  - custom_param = 100
```

å½’ç±»ç»“æœï¼š
```
1. period
   â†’ åŒ¹é… "period" è§„åˆ™ (.*period.*)
   â†’ å½’ç±»ï¼šå‘¨æœŸç±»
   â†’ èŒƒå›´ï¼š[10, 50]

2. devfactor
   â†’ åŒ¹é… "std_dev" è§„åˆ™ (.*dev.*factor.*)
   â†’ å½’ç±»ï¼šæ ‡å‡†å·®å€æ•°
   â†’ èŒƒå›´ï¼š[1.0, 4.0]

3. fast_ma
   â†’ åŒ¹é… "fast_period" è§„åˆ™ (.*fast.*)
   â†’ å½’ç±»ï¼šå¿«é€Ÿå‘¨æœŸ
   â†’ èŒƒå›´ï¼š[5, 20]

4. slow_ma
   â†’ åŒ¹é… "slow_period" è§„åˆ™ (.*slow.*)
   â†’ å½’ç±»ï¼šæ…¢é€Ÿå‘¨æœŸ
   â†’ èŒƒå›´ï¼š[15, 60]

5. custom_param
   â†’ æ‰€æœ‰è§„åˆ™éƒ½ä¸åŒ¹é…
   â†’ å½’ç±»ï¼šæœªè¯†åˆ«ï¼ˆé»˜è®¤è§„åˆ™ï¼‰
   â†’ èŒƒå›´ï¼š[50, 200]
```

#### âš™ï¸ åŒé‡çº¦æŸæœºåˆ¶

ç³»ç»ŸåŒæ—¶ä½¿ç”¨**ç›¸å¯¹å€æ•°**å’Œ**ç»å¯¹è¾¹ç•Œ**æ¥ç¡®ä¿å‚æ•°èŒƒå›´åˆç†ï¼š

```
ç¤ºä¾‹ 1ï¼šå‘¨æœŸå‚æ•° period=20
  ç›¸å¯¹èŒƒå›´ï¼š20 Ã— [0.5, 2.5] = [10, 50]
  ç»å¯¹è¾¹ç•Œï¼š[5, 200]
  æœ€ç»ˆèŒƒå›´ï¼šmax(10, 5) ~ min(50, 200) = [10, 50] âœ“

ç¤ºä¾‹ 2ï¼šå‘¨æœŸå‚æ•° period=150 (é»˜è®¤å€¼è¿‡å¤§)
  ç›¸å¯¹èŒƒå›´ï¼š150 Ã— [0.5, 2.5] = [75, 375]
  ç»å¯¹è¾¹ç•Œï¼š[5, 200]
  æœ€ç»ˆèŒƒå›´ï¼šmax(75, 5) ~ min(375, 200) = [75, 200] âœ“
  â†’ ç»å¯¹è¾¹ç•Œé˜²æ­¢æœç´¢èŒƒå›´è¿‡å¤§
```

### 6. ä¸¤é˜¶æ®µä¼˜åŒ–ç®—æ³• ğŸ†• v2.1

ç³»ç»Ÿä½¿ç”¨**ä¸¤é˜¶æ®µä¼˜åŒ–ç­–ç•¥**ï¼šæ­£æ€åˆ†å¸ƒæ¢ç´¢ + TPEè´å¶æ–¯åˆ©ç”¨ã€‚

#### ğŸ¯ ä¸¤é˜¶æ®µä¼˜åŒ–æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ 1ï¼šæ­£æ€åˆ†å¸ƒæ¢ç´¢ (30% è¯•éªŒ) ğŸ†•               â”‚
â”‚  ç›®çš„ï¼šä»¥é»˜è®¤å‚æ•°ä¸ºä¸­å¿ƒï¼Œé«˜æ•ˆæ¢ç´¢é«˜ä»·å€¼åŒºåŸŸ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
é‡‡æ ·ç­–ç•¥ï¼šæˆªæ–­æ­£æ€åˆ†å¸ƒ
  - ä¸­å¿ƒç‚¹ï¼šç­–ç•¥é»˜è®¤å‚æ•°å€¼
  - æ ‡å‡†å·®ï¼šå‚æ•°èŒƒå›´çš„ 25%
  - è¾¹ç•Œï¼šå‚æ•°æœç´¢ç©ºé—´çš„ä¸Šä¸‹ç•Œ

ç¤ºä¾‹ï¼ˆperiod å‚æ•°ï¼Œé»˜è®¤å€¼20ï¼ŒèŒƒå›´[14,26]ï¼‰ï¼š
  æ­£æ€åˆ†å¸ƒ N(20, 3Â²)ï¼Œæˆªæ–­äº [14, 26]
  
  æ¦‚ç‡å¯†åº¦
     â†‘
     |       â•±â•²
     |      â•±  â•²      â† é›†ä¸­åœ¨é»˜è®¤å€¼é™„è¿‘
     |     â•±    â•²
     |    â•±      â•²
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ period
         14  20  26

Trial 1: é»˜è®¤å‚æ•° {period: 20, devfactor: 2.0}
Trial 2: æ­£æ€é‡‡æ · {period: 18, devfactor: 2.1}
Trial 3: æ­£æ€é‡‡æ · {period: 22, devfactor: 1.9}
...

ä¼˜åŠ¿ï¼š
  âœ… ä¼˜å…ˆæ¢ç´¢é»˜è®¤å‚æ•°é™„è¿‘çš„é«˜ä»·å€¼åŒºåŸŸ
  âœ… é¿å…æµªè´¹èµ„æºåœ¨æç«¯å€¼åŒºåŸŸ
  âœ… ä¸ºè´å¶æ–¯é˜¶æ®µæä¾›é«˜è´¨é‡çš„åˆå§‹æ•°æ®

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ 2ï¼šè´å¶æ–¯æ™ºèƒ½é‡‡æ · (70% è¯•éªŒ)                â”‚
â”‚  ç›®çš„ï¼šåˆ©ç”¨å†å²ä¿¡æ¯ï¼Œç²¾ç¡®å®šä½æœ€ä¼˜å‚æ•°             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
åˆå§‹åŒ–ï¼šå°†æ¢ç´¢é˜¶æ®µæœ€ä½³å‚æ•°ä½œä¸ºèµ·ç‚¹

TPE ç®—æ³•æµç¨‹ï¼š
æ­¥éª¤ 1ï¼šåˆ’åˆ†å¥½åç»“æœ
  - æŒ‰ä¼˜åŒ–ç›®æ ‡æ’åºæ‰€æœ‰å†å²è¯•éªŒ
  - å‰ 20% æ ‡è®°ä¸º"å¥½ç»“æœ"
  - å 80% æ ‡è®°ä¸º"åç»“æœ"

æ­¥éª¤ 2ï¼šæ„å»ºæ¦‚ç‡æ¨¡å‹
  - l(x) = äº§ç”Ÿ"å¥½ç»“æœ"çš„å‚æ•°åˆ†å¸ƒ (é«˜æ–¯æ ¸å¯†åº¦ä¼°è®¡)
  - g(x) = äº§ç”Ÿ"åç»“æœ"çš„å‚æ•°åˆ†å¸ƒ (é«˜æ–¯æ ¸å¯†åº¦ä¼°è®¡)

æ­¥éª¤ 3ï¼šè®¡ç®—æœŸæœ›æ”¹è¿› (EI)
  - EI(x) = l(x) / g(x)
  - é«˜ EI å€¼ = è¯¥å‚æ•°ç»„åˆæ›´å¯èƒ½äº§ç”Ÿå¥½ç»“æœ

æ­¥éª¤ 4ï¼šåœ¨é«˜ EI åŒºåŸŸé‡‡æ ·
  - é€‰æ‹© EI æœ€é«˜çš„å‚æ•°ç»„åˆè¿›è¡Œä¸‹ä¸€æ¬¡è¯•éªŒ
  - æ›´æ–°å†å²è®°å½•ï¼Œé‡å¤æ­¥éª¤ 1-4
```

#### ğŸ“Š åŠ¨æ€è¯•éªŒæ¬¡æ•°è®¡ç®— ğŸ†•

ç³»ç»Ÿæ ¹æ®å‚æ•°æ•°é‡è‡ªåŠ¨è®¡ç®—æ¨èè¯•éªŒæ¬¡æ•°ï¼š

```
æ€»è¯•éªŒæ¬¡æ•° = åŸºç¡€å€¼(30) + å‚æ•°æ•°é‡ Ã— æ¯å‚æ•°å¢é‡(10)

é™åˆ¶èŒƒå›´ï¼š[20, 200]

åˆ†é…æ¯”ä¾‹ï¼š
  - æ¢ç´¢é˜¶æ®µï¼š30%
  - åˆ©ç”¨é˜¶æ®µï¼š70%

ç¤ºä¾‹ï¼š
  3ä¸ªå‚æ•°ï¼š30 + 3Ã—10 = 60æ¬¡ (æ¢ç´¢18 + åˆ©ç”¨42)
  5ä¸ªå‚æ•°ï¼š30 + 5Ã—10 = 80æ¬¡ (æ¢ç´¢24 + åˆ©ç”¨56)
  8ä¸ªå‚æ•°ï¼š30 + 8Ã—10 = 110æ¬¡ (æ¢ç´¢33 + åˆ©ç”¨77)
  15ä¸ªå‚æ•°ï¼š30 + 15Ã—10 = 180æ¬¡ (æ¢ç´¢54 + åˆ©ç”¨126)
```

#### ğŸ“ˆ æ¦‚ç‡æ¨¡å‹ç¤ºä¾‹

å‡è®¾ä¼˜åŒ– `period` å‚æ•°ï¼Œå·²å®Œæˆ 20 æ¬¡è¯•éªŒï¼š

```
å¥½ç»“æœå¯¹åº”çš„ period å€¼ï¼š[35, 38, 40, 42]
â†’ å»ºç«‹æ¦‚ç‡åˆ†å¸ƒ l(period)
  æœŸæœ›: 38.75, æ ‡å‡†å·®: 3.0
  
  æ¦‚ç‡å¯†åº¦
     â†‘
     |         â•±â•²
     |        â•±  â•²      â† é›†ä¸­åœ¨ 35-42
     |       â•±    â•²
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ period
          30  40  50

åç»“æœå¯¹åº”çš„ period å€¼ï¼š[15, 22, 28, 45, 50, ...]
â†’ å»ºç«‹æ¦‚ç‡åˆ†å¸ƒ g(period)
  æœŸæœ›: 32.0, æ ‡å‡†å·®: 13.5
  
  æ¦‚ç‡å¯†åº¦
     â†‘
     |      â•±â”€â”€â”€â”€â”€â•²    â† åˆ†å¸ƒå¾ˆåˆ†æ•£
     |     â•±       â•²
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ period
          20  40  60

è®¡ç®— EI å¹¶é‡‡æ ·ï¼š
  period=39: EI = l(39)/g(39) = 0.13/0.03 = 4.3 âœ“ é«˜ä¼˜å…ˆçº§
  period=18: EI = l(18)/g(18) = 0.01/0.05 = 0.2   ä½ä¼˜å…ˆçº§
  
â†’ ä¸‹ä¸€æ¬¡è¯•éªŒé€‰æ‹© periodâ‰ˆ39
```

#### ğŸ”„ è¿­ä»£ä¼˜åŒ–

```
Trial 11: æ ¹æ®æ¦‚ç‡æ¨¡å‹å»ºè®® â†’ æµ‹è¯• â†’ æ›´æ–°å†å²
Trial 12: æ ¹æ®æ–°å†å²é‡æ–°å»ºæ¨¡ â†’ æµ‹è¯• â†’ æ›´æ–°å†å²
Trial 13: ...
â†’ æŒç»­æ”¹è¿›ï¼Œé€æ¸æ”¶æ•›åˆ°æœ€ä¼˜å‚æ•°
```

### 7. ä¸ºä»€ä¹ˆè¿™æ ·åšæ˜¯æ™ºèƒ½çš„ï¼Ÿ

| ç‰¹æ€§ | éšæœºæœç´¢ | TPE æ™ºèƒ½æœç´¢ |
|------|---------|-------------|
| **åˆ©ç”¨å†å²** | âŒ ä¸è€ƒè™‘å†å²ç»“æœ | âœ… åŸºäºå†å²æ„å»ºæ¦‚ç‡æ¨¡å‹ |
| **æœç´¢æ•ˆç‡** | åˆ°å¤„ä¹±è¯•ï¼Œæ•ˆç‡ä½ | é›†ä¸­åœ¨é«˜ä»·å€¼åŒºåŸŸï¼Œæ•ˆç‡é«˜ |
| **æ”¶æ•›é€Ÿåº¦** | æ…¢ï¼Œéœ€è¦å¤§é‡è¯•éªŒ | å¿«ï¼Œ20-50 æ¬¡é€šå¸¸è¶³å¤Ÿ |
| **é€‚åº”æ€§** | å›ºå®šç­–ç•¥ | è‡ªé€‚åº”è°ƒæ•´æœç´¢æ–¹å‘ |
| **ç»“æœè´¨é‡** | ä¾èµ–è¿æ°” | ç¨³å®šæ‰¾åˆ°è¾ƒä¼˜è§£ |

**å®é™…å¯¹æ¯”ï¼š**
```
éšæœºæœç´¢ 50 æ¬¡ï¼š
  æœ€ä¼˜ Sharpe: 0.68 (è¿æ°”å¥½æ‰èƒ½æ‰¾åˆ°)

TPE æœç´¢ 50 æ¬¡ï¼š
  æœ€ä¼˜ Sharpe: 0.89 (åŸºäºæ™ºèƒ½é‡‡æ ·ï¼Œç¨³å®šè¾¾åˆ°)
  
æ•ˆç‡æå‡ï¼šçº¦ 30-50%
```

#### ğŸ“ˆ æ€§èƒ½ä¼˜åŠ¿å¯¹æ¯”

**ä¼˜åŒ–æ•ˆç‡å¯¹æ¯”è¡¨ï¼š**

| ä¼˜åŒ–æ–¹æ³• | åˆå§‹èŒƒå›´ | è¾¹ç•Œå¤„ç† | è¯•éªŒæ¬¡æ•° | Sharpeæå‡ | æ•ˆç‡è¯„çº§ |
|---------|---------|---------|---------|-----------|---------|
| éšæœºæœç´¢ | å›ºå®šèŒƒå›´ | âŒ æ—  | 100æ¬¡ | +12% | â­â­ |
| ä¼ ç»Ÿè´å¶æ–¯ | Â±50-150% | âŒ æ—  | 100æ¬¡ | +18% | â­â­â­ |
| **è‡ªé€‚åº”ä¼˜åŒ–** | **Â±30%** | **âœ… è‡ªåŠ¨æ‰©å±•** | **50+40æ¬¡** | **+25%** | **â­â­â­â­â­** |


### 8. å‚æ•°çº¦æŸå¤„ç†

ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«å¹¶å¤„ç†å‚æ•°é—´çš„çº¦æŸå…³ç³»ï¼š

```python
# å¿«é€Ÿ/æ…¢é€Ÿå‘¨æœŸçº¦æŸ
fast_period < slow_period
â†’ è‡ªåŠ¨è°ƒæ•´ï¼šfast_max < slow_min

# RSI é˜ˆå€¼çº¦æŸ
rsi_oversold < rsi_overbought
â†’ è‡ªåŠ¨è°ƒæ•´ï¼šoversold_max=45, overbought_min=55
```

### 9. ä¼˜åŒ–ç»“æœåˆ†æ

ä¼˜åŒ–å®Œæˆåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†æå‚æ•°ç©ºé—´ä½¿ç”¨æƒ…å†µï¼š

```
å‚æ•°ç©ºé—´åˆ†æï¼š
  period = 48 (èŒƒå›´ [10, 50])
  â†’ æ¥è¿‘ä¸Šç•Œï¼Œå»ºè®®æ‰©å¤§èŒƒå›´åˆ° [10, 80]
  
  devfactor = 2.1 (èŒƒå›´ [1.0, 4.0])
  â†’ ä½äºä¸­é—´åŒºåŸŸï¼ŒèŒƒå›´åˆç† âœ“
```

**è¯¦ç»†æ–‡æ¡£ï¼š** å‚è§ [å‚æ•°ç©ºé—´ä¼˜åŒ–æŒ‡å—.md](å‚æ•°ç©ºé—´ä¼˜åŒ–æŒ‡å—.md)

---

## ğŸ“œ è®¸å¯è¯

æœ¬å·¥å…·æ˜¯é‡åŒ–äº¤æ˜“ç ”ç©¶é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

---

## ğŸ†• ç‰ˆæœ¬æ›´æ–°

### v2.1.0 (2026-02-02) - å¢å¼ºé‡‡æ ·å™¨ç‰ˆæœ¬

**é‡å¤§æ›´æ–°ï¼š**
- ğŸ² **æ­£æ€åˆ†å¸ƒé‡‡æ ·**ï¼šåˆå§‹æ¢ç´¢é˜¶æ®µä½¿ç”¨æ­£æ€åˆ†å¸ƒé‡‡æ ·æ›¿ä»£å‡åŒ€é‡‡æ ·ï¼Œä»¥é»˜è®¤å‚æ•°ä¸ºä¸­å¿ƒè¿›è¡Œé‡‡æ ·ï¼Œæ›´å¥½åœ°æ¢ç´¢é«˜ä»·å€¼å‚æ•°åŒºåŸŸ
- âš¡ **ä¸¤é˜¶æ®µä¼˜åŒ–**ï¼šæ¢ç´¢é˜¶æ®µï¼ˆæ­£æ€åˆ†å¸ƒé‡‡æ ·ï¼Œ30%è¯•éªŒï¼‰+ åˆ©ç”¨é˜¶æ®µï¼ˆè´å¶æ–¯TPEï¼Œ70%è¯•éªŒï¼‰ï¼Œå¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨
- ğŸ“Š **åŠ¨æ€è¯•éªŒæ¬¡æ•°**ï¼šæ ¹æ®å‚æ•°æ•°é‡è‡ªåŠ¨è®¡ç®—æ¨èè¯•éªŒæ¬¡æ•°
  - åŸºç¡€å…¬å¼ï¼š`æ€»è¯•éªŒ = 30 + å‚æ•°æ•°é‡ Ã— 10`
  - èŒƒå›´é™åˆ¶ï¼šæœ€å°‘20æ¬¡ï¼Œæœ€å¤š200æ¬¡
  - ç¤ºä¾‹ï¼š5ä¸ªå‚æ•° â†’ æ¨è80æ¬¡ï¼ˆæ¢ç´¢24æ¬¡ + åˆ©ç”¨56æ¬¡ï¼‰
- ğŸ” **è¾¹ç•ŒäºŒæ¬¡æœç´¢**ï¼šä¼˜åŒ–å®Œæˆåè‡ªåŠ¨æ£€æµ‹è¾¹ç•Œå‚æ•°ï¼Œæ‰©å±•æœç´¢èŒƒå›´å¹¶è¿›è¡Œé’ˆå¯¹æ€§äºŒæ¬¡æœç´¢

**æ–°å¢å‘½ä»¤è¡Œå‚æ•°ï¼š**
```bash
--no-enhanced-sampler   # ç¦ç”¨æ­£æ€åˆ†å¸ƒé‡‡æ ·ï¼Œä½¿ç”¨ä¼ ç»Ÿå‡åŒ€é‡‡æ ·
--no-dynamic-trials     # ç¦ç”¨åŠ¨æ€è¯•éªŒæ¬¡æ•°
--no-boundary-search    # ç¦ç”¨è¾¹ç•ŒäºŒæ¬¡æœç´¢
--max-boundary-rounds N # è®¾ç½®è¾¹ç•Œæœç´¢æœ€å¤§è½®æ•°ï¼ˆé»˜è®¤2ï¼‰
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```bash
# é»˜è®¤ä½¿ç”¨æ‰€æœ‰æ–°åŠŸèƒ½
python run_optimizer.py -d data.csv -s strategy.py

# ç¦ç”¨åŠ¨æ€è¯•éªŒæ¬¡æ•°ï¼Œä½¿ç”¨å›ºå®š100æ¬¡
python run_optimizer.py -d data.csv -s strategy.py --trials 100 --no-dynamic-trials

# ä½¿ç”¨ä¼ ç»Ÿå‡åŒ€é‡‡æ ·
python run_optimizer.py -d data.csv -s strategy.py --no-enhanced-sampler
```

**æ€§èƒ½æå‡ï¼š**
- âš¡ æ­£æ€åˆ†å¸ƒé‡‡æ ·ä½¿æ¢ç´¢æ›´èšç„¦äºé«˜ä»·å€¼åŒºåŸŸ
- ğŸ“ˆ ä¸¤é˜¶æ®µä¼˜åŒ–ç­–ç•¥æå‡æ•´ä½“æœç´¢æ•ˆç‡çº¦15-20%
- ğŸ¯ åŠ¨æ€è¯•éªŒæ¬¡æ•°ç¡®ä¿ä¸åŒå¤æ‚åº¦ç­–ç•¥éƒ½èƒ½å……åˆ†æ¢ç´¢
- ğŸ”„ è¾¹ç•ŒäºŒæ¬¡æœç´¢æœ‰æ•ˆé¿å…é—æ¼è¾¹ç•Œæœ€ä¼˜è§£

**æŠ€æœ¯ç»†èŠ‚ï¼š**
- æ­£æ€åˆ†å¸ƒæ ‡å‡†å·®ï¼šå‚æ•°èŒƒå›´çš„25%
- æ¢ç´¢é˜¶æ®µæ¯”ä¾‹ï¼š30%
- è¾¹ç•Œæ£€æµ‹é˜ˆå€¼ï¼š10%
- è¾¹ç•Œæ‰©å±•å› å­ï¼š1.5å€

---

### v2.0.0 (2026-01-29)

**é‡å¤§æ›´æ–°ï¼š**
- ğŸ¯ **è‡ªé€‚åº”å‚æ•°ç©ºé—´ä¼˜åŒ–**ï¼šåˆå§‹èŒƒå›´ç¼©å°è‡³Â±30%ï¼Œè‡ªåŠ¨è¾¹ç•Œæ‰©å±•æœºåˆ¶
- ğŸ”„ **è‡ªåŠ¨è¾¹ç•Œæ‰©å±•**ï¼šå½“å‚æ•°è§¦åŠè¾¹ç•Œæ—¶è‡ªåŠ¨æ‰©å±•1.5å€ï¼Œæœ€å¤š2è½®
- ğŸ“Š **ä¸“ä¸šæŒ‡æ ‡è®¡ç®—**ï¼šä½¿ç”¨ pyfolio/empyrical è®¡ç®—ä¸“ä¸šé‡‘èæŒ‡æ ‡
- ğŸ² **é»˜è®¤å‚æ•°é‡‡æ ·**ï¼šä¼˜åŒ–é¦–ä¸ªè¯•éªŒä½¿ç”¨ç­–ç•¥é»˜è®¤å‚æ•°
- ğŸ“¦ **æ‰¹é‡å¤„ç†æ”¯æŒ**ï¼šæ”¯æŒä¸€æ¬¡ä¼˜åŒ–å¤šä¸ªCSVæ–‡ä»¶
- ğŸ“ˆ **Sortino/Calmar/Omega**ï¼šæ–°å¢ä¸“ä¸šé£é™©è°ƒæ•´æ”¶ç›ŠæŒ‡æ ‡

**æ€§èƒ½æå‡ï¼š**
- âš¡ åˆå§‹æœç´¢èŒƒå›´æ›´ç²¾å‡†ï¼ˆÂ±30% vs Â±50-150%ï¼‰
- ğŸ¯ è¾¹ç•Œæ‰©å±•æœºåˆ¶é¿å…é—æ¼æœ€ä¼˜è§£
- ğŸ“Š ä¸“ä¸šæŒ‡æ ‡æä¾›æ›´å…¨é¢çš„ç­–ç•¥è¯„ä¼°
- ğŸ”„ è‡ªé€‚åº”ä¼˜åŒ–æå‡7%+ Sharpeæ¯”ç‡ï¼ˆå®æµ‹AGç­–ç•¥ï¼‰

**æ–°å¢ä¾èµ–ï¼š**
- `empyrical>=0.5.5` - ä¸“ä¸šé‡‘èæŒ‡æ ‡è®¡ç®—åº“

### v1.1.0 (2026-01-22)

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ¨ æŒ‡å®šå‚æ•°ä¼˜åŒ–åŠŸèƒ½ï¼ˆ`--params-file`ï¼‰
- âœ¨ æ™ºèƒ½å‚æ•°ç©ºé—´è‡ªåŠ¨ç”Ÿæˆ
- âœ¨ å‚æ•°ç©ºé—´ä½¿ç”¨æƒ…å†µåˆ†æ
- âœ¨ å‚æ•°çº¦æŸè‡ªåŠ¨å¤„ç†ï¼ˆå¦‚ fast < slowï¼‰
- ğŸ“Š ä¼˜åŒ–åè‡ªåŠ¨æä¾›å‚æ•°ç©ºé—´æ”¹è¿›å»ºè®®

**æ”¹è¿›ï¼š**
- ğŸš€ æ ¹æ®å‚æ•°ç±»å‹æ™ºèƒ½è®¾ç½®æœç´¢èŒƒå›´
- ğŸ“ˆ æå‡ä¼˜åŒ–æ•ˆç‡ï¼Œå‡å°‘æ— æ•ˆæœç´¢
- ğŸ’¡ æ–°å¢å‚æ•°æ•æ„Ÿæ€§åˆ†æç¤ºä¾‹
- ğŸ“– å®Œå–„æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹

---

**æ›´æ–°æ—¶é—´**: 2026-02-02  
**ç‰ˆæœ¬**: 2.1.0  
**ä½œè€…**: Peter
